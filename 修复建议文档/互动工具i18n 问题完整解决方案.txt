


å®Œæ•´çš„i18nä¿®å¤æ–¹æ¡ˆ

// 1. ä¿®å¤åçš„ i18n.js æ–‡ä»¶
// public/zh/interactive-tools/period-pain-impact-calculator/i18n.js

let i18nInstance = null;
let isInitialized = false;
const initPromise = new Promise((resolve) => {
  window.i18nResolve = resolve;
});

// å®Œæ•´çš„ç¿»è¯‘èµ„æº
const translations = {
  zh: {
    translation: {
      // ç—‡çŠ¶è¯„ä¼°å™¨ç›¸å…³
      symptomAssessor: {
        title: "ç»æœŸç–¼ç—›å½±å“è¯„ä¼°",
        subtitle: "è¯„ä¼°æ‚¨çš„ç»æœŸç–¼ç—›å¯¹æ—¥å¸¸ç”Ÿæ´»çš„å½±å“ç¨‹åº¦"
      },

      // å·¥ä½œåœºæ‰€è¯„ä¼°
      workplaceAssessment: {
        title: "å·¥ä½œåœºæ‰€å½±å“è¯„ä¼°"
      },

      // é€šç”¨æŒ‰é’®å’Œç•Œé¢å…ƒç´ 
      common: {
        buttons: {
          start: "å¼€å§‹è¯„ä¼°",
          next: "ä¸‹ä¸€æ­¥",
          previous: "ä¸Šä¸€æ­¥",
          submit: "æäº¤",
          reset: "é‡æ–°å¼€å§‹"
        },
        disclaimer: "å…è´£å£°æ˜ï¼šæ­¤å·¥å…·ä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—å»ºè®®ã€‚å¦‚æœ‰å¥åº·é—®é¢˜ï¼Œè¯·å’¨è¯¢åŒ»ç–—ä¸“ä¸šäººå£«ã€‚"
      },

      // ç–¼ç—›ä½ç½®ç›¸å…³
      questions: {
        painLocation: {
          title: "ç–¼ç—›ä½ç½®",
          options: {
            lowerAbdomen: "ä¸‹è…¹éƒ¨",
            lowerBack: "è…°éƒ¨",
            upperThighs: "å¤§è…¿ä¸Šéƒ¨",
            fullPelvis: "æ•´ä¸ªç›†è…”åŒºåŸŸ",
            sideFlank: "ä¾§è…¹",
            variable: "ä½ç½®å˜åŒ–"
          }
        },

        painLevel: {
          title: "ç–¼ç—›ç¨‹åº¦",
          options: {
            mild: "è½»åº¦",
            moderate: "ä¸­åº¦",
            severe: "é‡åº¦",
            verySevere: "éå¸¸ä¸¥é‡"
          }
        },

        painDuration: {
          title: "ç–¼ç—›æŒç»­æ—¶é—´",
          options: {
            short: "1-2å¤©",
            medium: "3-5å¤©",
            long: "6å¤©æˆ–æ›´é•¿"
          }
        },

        accompanyingSymptoms: {
          title: "ä¼´éšç—‡çŠ¶",
          options: {
            fatigue: "ç–²åŠ³",
            headache: "å¤´ç—›",
            nausea: "æ¶å¿ƒ",
            digestive: "æ¶ˆåŒ–é—®é¢˜",
            mood: "æƒ…ç»ªå˜åŒ–",
            bloating: "è…¹èƒ€",
            breastTenderness: "ä¹³æˆ¿èƒ€ç—›",
            dizziness: "å¤´æ™•"
          }
        }
      }
    }
  }
};

// i18next é…ç½®å’Œåˆå§‹åŒ–
function initI18n() {
  if (isInitialized) {
    return Promise.resolve(i18nInstance);
  }

  // æ£€æŸ¥ i18next æ˜¯å¦å·²åŠ è½½
  if (typeof window.i18next === 'undefined') {
    console.error('i18next library not loaded');
    return Promise.reject(new Error('i18next library not loaded'));
  }

  try {
    i18nInstance = window.i18next.createInstance();

    i18nInstance.init({
      lng: 'zh',
      fallbackLng: 'zh',
      debug: true,

      // é‡è¦ï¼šä½¿ç”¨ 'translation' ä½œä¸ºé»˜è®¤å‘½åç©ºé—´
      ns: ['translation'],
      defaultNS: 'translation',

      // ç›´æ¥å†…è”èµ„æºï¼Œé¿å…åŠ è½½é—®é¢˜
      resources: translations,

      // æ’å€¼é…ç½®
      interpolation: {
        escapeValue: false
      },

      // å¤„ç†ç¼ºå¤±é”®çš„å›è°ƒ
      saveMissing: true,
      missingKeyHandler: (lng, ns, key, fallbackValue) => {
        console.warn(`Missing translation key: ${key} for language: ${lng}, namespace: ${ns}`);
        return key; // è¿”å›é”®åä½œä¸ºåå¤‡
      },

      // React ç‰¹å®šé…ç½®
      react: {
        bindI18n: 'languageChanged loaded',
        bindI18nStore: 'added removed',
        transEmptyNodeValue: '',
        transSupportBasicHtmlNodes: true,
        transKeepBasicHtmlNodesFor: ['br', 'strong', 'i'],
      }
    }, (err, t) => {
      if (err) {
        console.error('i18n initialization failed:', err);
        return;
      }

      console.log('i18n initialized successfully');
      isInitialized = true;

      // æµ‹è¯•ç¿»è¯‘æ˜¯å¦å·¥ä½œ
      console.log('Test translation:', t('symptomAssessor.title'));

      if (window.i18nResolve) {
        window.i18nResolve(i18nInstance);
      }
    });

    return initPromise;
  } catch (error) {
    console.error('Error initializing i18n:', error);
    return Promise.reject(error);
  }
}

// ç¿»è¯‘å‡½æ•°
function t(key, options = {}) {
  if (!i18nInstance || !isInitialized) {
    console.warn(`Translation called before initialization: ${key}`);
    return key; // è¿”å›é”®åä½œä¸ºåå¤‡
  }

  try {
    const result = i18nInstance.t(key, options);
    if (result === key && key.includes('.')) {
      // å¦‚æœç¿»è¯‘å¤±è´¥ï¼Œå°è¯•è®°å½•è¯¦ç»†ä¿¡æ¯
      console.warn(`Translation not found for key: ${key}`);
    }
    return result;
  } catch (error) {
    console.error(`Error translating key "${key}":`, error);
    return key;
  }
}

// è·å– i18n å®ä¾‹
function getI18nInstance() {
  return i18nInstance;
}

// ç¡®ä¿åœ¨ DOM åŠ è½½å®Œæˆååˆå§‹åŒ–
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initI18n);
} else {
  // DOM å·²ç»åŠ è½½å®Œæˆï¼Œç«‹å³åˆå§‹åŒ–
  setTimeout(initI18n, 0);
}

// å¯¼å‡ºå‡½æ•°åˆ°å…¨å±€ä½œç”¨åŸŸ
window.t = t;
window.getI18nInstance = getI18nInstance;
window.initI18n = initI18n;
window.i18nReady = initPromise;

// 2. ä¿®å¤åçš„ HTML æ–‡ä»¶å¤´éƒ¨
/*
è¯·ç¡®ä¿åœ¨ HTML æ–‡ä»¶çš„ <head> éƒ¨åˆ†æŒ‰æ­£ç¡®é¡ºåºåŠ è½½ï¼š

<script src="https://cdnjs.cloudflare.com/ajax/libs/i18next/21.10.0/i18next.min.js"></script>
<script src="i18n.js"></script>
*/

// 3. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ç¿»è¯‘çš„æ­£ç¡®æ–¹å¼
/*
åœ¨æ‚¨çš„ React ç»„ä»¶æˆ– JavaScript ä»£ç ä¸­ï¼š

// ç­‰å¾… i18n åˆå§‹åŒ–å®Œæˆ
window.i18nReady.then(() => {
  // ç°åœ¨å¯ä»¥å®‰å…¨ä½¿ç”¨ç¿»è¯‘
  const title = window.t('symptomAssessor.title');
  console.log('Translated title:', title);

  // æ›´æ–°DOM
  const titleElement = document.querySelector('.symptom-assessor-title');
  if (titleElement) {
    titleElement.textContent = title;
  }
});

// æˆ–è€…åœ¨å‡½æ•°ä¸­æ£€æŸ¥åˆå§‹åŒ–çŠ¶æ€
function updateTranslations() {
  if (!window.getI18nInstance()) {
    console.log('i18n not ready, waiting...');
    window.i18nReady.then(updateTranslations);
    return;
  }

  // æ›´æ–°æ‰€æœ‰ç¿»è¯‘
  document.querySelector('.symptom-title').textContent = window.t('symptomAssessor.title');
  document.querySelector('.symptom-subtitle').textContent = window.t('symptomAssessor.subtitle');
  document.querySelector('.start-button').textContent = window.t('common.buttons.start');
  document.querySelector('.workplace-title').textContent = window.t('workplaceAssessment.title');
  document.querySelector('.disclaimer').textContent = window.t('common.disclaimer');
}
*/

i18né—®é¢˜è°ƒè¯•å’Œä¿®å¤æŒ‡å—

# ğŸ”§ i18n é—®é¢˜å®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ“‹ **æ­¥éª¤1ï¼šç«‹å³è¯Šæ–­**

åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¿è¡Œä»¥ä¸‹ä»£ç æ¥è¯Šæ–­å½“å‰çŠ¶æ€ï¼š

```javascript
// 1. æ£€æŸ¥ i18next åº“æ˜¯å¦åŠ è½½
console.log('i18next loaded:', typeof window.i18next !== 'undefined');

// 2. æ£€æŸ¥ i18n.js æ˜¯å¦è¢«æ‰§è¡Œ
console.log('i18n.js loaded:', typeof window.t !== 'undefined');

// 3. æ£€æŸ¥ç¿»è¯‘èµ„æº
if (window.getI18nInstance) {
  const instance = window.getI18nInstance();
  if (instance) {
    console.log('Current language:', instance.language);
    console.log('Available resources:', instance.options.resources);
    console.log('Test translation:', instance.t('symptomAssessor.title'));
  }
}

// 4. æ‰‹åŠ¨æµ‹è¯•ç¿»è¯‘
if (window.t) {
  console.log('Manual test:', window.t('symptomAssessor.title'));
}
```

## ğŸ› ï¸ **æ­¥éª¤2ï¼šæ–‡ä»¶æ›¿æ¢**

### 2.1 æ›¿æ¢ i18n.js æ–‡ä»¶

å°†ç¬¬ä¸€ä¸ªå·¥ä»¶ä¸­çš„å®Œæ•´ä»£ç ä¿å­˜ä¸ºï¼š
```
public/zh/interactive-tools/period-pain-impact-calculator/i18n.js
```

### 2.2 ä¿®æ”¹ HTML æ–‡ä»¶å¤´éƒ¨

ç¡®ä¿ HTML æ–‡ä»¶æŒ‰ä»¥ä¸‹é¡ºåºåŠ è½½è„šæœ¬ï¼š

```html
<head>
    <!-- å…¶ä»–å¤´éƒ¨å†…å®¹ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/i18next/21.10.0/i18next.min.js"></script>
    <script src="i18n.js"></script>
</head>
```

## ğŸ” **æ­¥éª¤3ï¼šé€æ­¥è°ƒè¯•**

### 3.1 éªŒè¯æ–‡ä»¶åŠ è½½

åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Network æ ‡ç­¾é¡µä¸­ï¼š
1. åˆ·æ–°é¡µé¢
2. æŸ¥æ‰¾ `i18n.js` è¯·æ±‚
3. ç¡®è®¤çŠ¶æ€ç ä¸º 200
4. æ£€æŸ¥å“åº”å†…å®¹æ˜¯å¦å®Œæ•´

### 3.2 æ£€æŸ¥æ§åˆ¶å°è¾“å‡º

æ­£å¸¸æƒ…å†µä¸‹åº”è¯¥çœ‹åˆ°ï¼š
```
i18n initialized successfully
Test translation: ç»æœŸç–¼ç—›å½±å“è¯„ä¼°
```

### 3.3 æ‰‹åŠ¨åˆå§‹åŒ–æµ‹è¯•

å¦‚æœè‡ªåŠ¨åˆå§‹åŒ–å¤±è´¥ï¼Œåœ¨æ§åˆ¶å°ä¸­æ‰‹åŠ¨è¿è¡Œï¼š

```javascript
// å¼ºåˆ¶åˆå§‹åŒ–
window.initI18n().then(() => {
    console.log('Manual init successful');
    console.log('Test:', window.t('symptomAssessor.title'));
}).catch(console.error);
```

## ğŸš€ **æ­¥éª¤4ï¼šåº”ç”¨ç¿»è¯‘**

### 4.1 åœ¨é¡µé¢åŠ è½½å®Œæˆååº”ç”¨ç¿»è¯‘

```javascript
// æ·»åŠ åˆ°é¡µé¢çš„ <script> æ ‡ç­¾ä¸­
window.addEventListener('DOMContentLoaded', function() {
    window.i18nReady.then(() => {
        // æ›´æ–°æ‰€æœ‰ç¿»è¯‘æ–‡æœ¬
        const elements = {
            '.symptom-assessor-title': 'symptomAssessor.title',
            '.symptom-assessor-subtitle': 'symptomAssessor.subtitle',
            '.start-button': 'common.buttons.start',
            '.workplace-assessment-title': 'workplaceAssessment.title',
            '.disclaimer': 'common.disclaimer'
        };

        Object.entries(elements).forEach(([selector, key]) => {
            const element = document.querySelector(selector);
            if (element) {
                element.textContent = window.t(key);
                console.log(`Updated ${selector}:`, window.t(key));
            } else {
                console.warn(`Element not found: ${selector}`);
            }
        });
    }).catch(error => {
        console.error('Translation update failed:', error);
    });
});
```

## ğŸ”„ **å¤‡ç”¨æ–¹æ¡ˆ1ï¼šç®€åŒ–ç‰ˆæœ¬**

å¦‚æœä¸Šè¿°æ–¹æ¡ˆä»æœ‰é—®é¢˜ï¼Œä½¿ç”¨è¿™ä¸ªæç®€ç‰ˆæœ¬ï¼š

```javascript
// ç®€åŒ–çš„ i18n.js
const simpleTranslations = {
    'symptomAssessor.title': 'ç»æœŸç–¼ç—›å½±å“è¯„ä¼°',
    'symptomAssessor.subtitle': 'è¯„ä¼°æ‚¨çš„ç»æœŸç–¼ç—›å¯¹æ—¥å¸¸ç”Ÿæ´»çš„å½±å“ç¨‹åº¦',
    'common.buttons.start': 'å¼€å§‹è¯„ä¼°',
    'workplaceAssessment.title': 'å·¥ä½œåœºæ‰€å½±å“è¯„ä¼°',
    'common.disclaimer': 'å…è´£å£°æ˜ï¼šæ­¤å·¥å…·ä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—å»ºè®®ã€‚å¦‚æœ‰å¥åº·é—®é¢˜ï¼Œè¯·å’¨è¯¢åŒ»ç–—ä¸“ä¸šäººå£«ã€‚'
};

window.t = function(key) {
    return simpleTranslations[key] || key;
};

// ç«‹å³åº”ç”¨ç¿»è¯‘
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            el.textContent = window.t(key);
        });
    }, 100);
});
```

ç„¶ååœ¨ HTML ä¸­ä½¿ç”¨ï¼š
```html
<h1 data-i18n="symptomAssessor.title">symptomAssessor.title</h1>
<p data-i18n="symptomAssessor.subtitle">symptomAssessor.subtitle</p>
<button data-i18n="common.buttons.start">common.buttons.start</button>
```

## ğŸ”„ **å¤‡ç”¨æ–¹æ¡ˆ2ï¼šç›´æ¥æ›¿æ¢**

å¦‚æœæ‰€æœ‰æ–¹æ¡ˆéƒ½å¤±è´¥ï¼Œç›´æ¥åœ¨ HTML ä¸­ç¡¬ç¼–ç ä¸­æ–‡ï¼š

```javascript
// ç›´æ¥æ›¿æ¢æ–‡æœ¬çš„è„šæœ¬
document.addEventListener('DOMContentLoaded', function() {
    const replacements = {
        'symptomAssessor.title': 'ç»æœŸç–¼ç—›å½±å“è¯„ä¼°',
        'symptomAssessor.subtitle': 'è¯„ä¼°æ‚¨çš„ç»æœŸç–¼ç—›å¯¹æ—¥å¸¸ç”Ÿæ´»çš„å½±å“ç¨‹åº¦',
        'common.buttons.start': 'å¼€å§‹è¯„ä¼°',
        'workplaceAssessment.title': 'å·¥ä½œåœºæ‰€å½±å“è¯„ä¼°',
        'common.disclaimer': 'å…è´£å£°æ˜ï¼šæ­¤å·¥å…·ä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—å»ºè®®ã€‚å¦‚æœ‰å¥åº·é—®é¢˜ï¼Œè¯·å’¨è¯¢åŒ»ç–—ä¸“ä¸šäººå£«ã€‚'
    };

    // æŸ¥æ‰¾å¹¶æ›¿æ¢æ‰€æœ‰åŒ…å«ç¿»è¯‘é”®çš„æ–‡æœ¬èŠ‚ç‚¹
    function walkTextNodes(node) {
        if (node.nodeType === 3) { // æ–‡æœ¬èŠ‚ç‚¹
            let text = node.textContent;
            Object.entries(replacements).forEach(([key, value]) => {
                if (text.includes(key)) {
                    text = text.replace(key, value);
                }
            });
            if (text !== node.textContent) {
                node.textContent = text;
            }
        } else {
            for (let child of node.childNodes) {
                walkTextNodes(child);
            }
        }
    }

    walkTextNodes(document.body);
});
```

## âš¡ **å¿«é€Ÿä¿®å¤å‘½ä»¤**

å¦‚æœæ‚¨æœ‰å‘½ä»¤è¡Œè®¿é—®æƒé™ï¼š

```bash
# 1. åœæ­¢å¼€å‘æœåŠ¡å™¨
pkill -f "next dev"

# 2. æ¸…ç†ç¼“å­˜
rm -rf .next/
rm -rf node_modules/.cache/

# 3. é‡æ–°å®‰è£…ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
npm install

# 4. é‡å¯æœåŠ¡å™¨
npm run dev
```

## ğŸ¯ **æµ‹è¯•æ¸…å•**

å®Œæˆä¿®å¤åï¼ŒéªŒè¯ä»¥ä¸‹é¡¹ç›®ï¼š

- [ ] æ§åˆ¶å°æ²¡æœ‰ "Translation key not found" é”™è¯¯
- [ ] é¡µé¢æ˜¾ç¤ºä¸­æ–‡æ–‡æœ¬è€Œä¸æ˜¯ç¿»è¯‘é”®
- [ ] `window.t('symptomAssessor.title')` è¿”å›ä¸­æ–‡
- [ ] æµè§ˆå™¨ Network æ ‡ç­¾æ˜¾ç¤º i18n.js æˆåŠŸåŠ è½½
- [ ] æ§åˆ¶å°æ˜¾ç¤º "i18n initialized successfully"

## ğŸ†˜ **å¦‚æœä»æœ‰é—®é¢˜**

è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. æ§åˆ¶å°ä¸­è¿è¡Œè¯Šæ–­ä»£ç çš„å®Œæ•´è¾“å‡º
2. Network æ ‡ç­¾ä¸­ i18n.js çš„çŠ¶æ€
3. ä»»ä½•é”™è¯¯ä¿¡æ¯çš„å®Œæ•´å †æ ˆè·Ÿè¸ª
4. æ‚¨ä½¿ç”¨çš„æ˜¯å“ªä¸ªå¤‡ç”¨æ–¹æ¡ˆ

è¿™æ ·æˆ‘å¯ä»¥æä¾›æ›´é’ˆå¯¹æ€§çš„è§£å†³æ–¹æ¡ˆï¼

æˆ‘æ¥å¸®æ‚¨åˆ†æå’Œè§£å†³è¿™ä¸ªi18nç¿»è¯‘é”®é—®é¢˜ã€‚ä»æˆªå›¾çœ‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„å›½é™…åŒ–é…ç½®é—®é¢˜ï¼Œè®©æˆ‘æä¾›ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆã€‚åŸºäºæœç´¢ç»“æœå’Œæ‚¨çš„é—®é¢˜æè¿°ï¼Œæˆ‘å‘ç°äº†å‡ ä¸ªå…³é”®çš„è§£å†³æ–¹å‘ã€‚è®©æˆ‘ä¸ºæ‚¨æä¾›ä¸€ä¸ªç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆï¼š

## ğŸ” **é—®é¢˜æ ¹å› åˆ†æ**

ä»æ§åˆ¶å°é”™è¯¯ `Translation key not found: "symptomAssessor.title"` æ¥çœ‹ï¼Œä¸»è¦é—®é¢˜æ˜¯ï¼š

1. **èµ„æºåŠ è½½å¤±è´¥** - i18nextæ— æ³•æ‰¾åˆ°ç¿»è¯‘èµ„æº
2. **å‘½åç©ºé—´é…ç½®é”™è¯¯** - ç¿»è¯‘é”®çš„å±‚çº§ç»“æ„ä¸åŒ¹é…
3. **åˆå§‹åŒ–æ—¶åºé—®é¢˜** - ç»„ä»¶æ¸²æŸ“æ—¶ç¿»è¯‘å°šæœªåŠ è½½å®Œæˆ

## ğŸ› ï¸ **å®Œæ•´è§£å†³æ–¹æ¡ˆ**ç°åœ¨è®©æˆ‘æä¾›è¯¦ç»†çš„è°ƒè¯•æ­¥éª¤å’Œå¤‡ç”¨è§£å†³æ–¹æ¡ˆï¼š## ğŸ¯ **æ€»ç»“ä¸å»ºè®®æ‰§è¡Œé¡ºåº**

åŸºäºæˆ‘çš„åˆ†æå’Œæœç´¢ç»“æœï¼Œæ‚¨çš„i18né—®é¢˜ä¸»è¦æºäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

### **ä¸»è¦é—®é¢˜åŸå› ï¼š**
1. **èµ„æºç»“æ„ä¸åŒ¹é…** - i18nextæ— æ³•æ­£ç¡®æ‰¾åˆ°åµŒå¥—çš„ç¿»è¯‘é”®
2. **å¼‚æ­¥åŠ è½½æ—¶åº** - ç»„ä»¶æ¸²æŸ“æ—¶ç¿»è¯‘èµ„æºå°šæœªå®Œå…¨åŠ è½½
3. **å‘½åç©ºé—´é…ç½®** - é»˜è®¤å‘½åç©ºé—´è®¾ç½®ä¸å½“

### **ğŸš€ æ¨èæ‰§è¡Œé¡ºåºï¼š**

**ç¬¬ä¸€ä¼˜å…ˆçº§ï¼ˆæ¨èï¼‰ï¼š**
1. ä½¿ç”¨ç¬¬ä¸€ä¸ªå·¥ä»¶ä¸­çš„å®Œæ•´ `i18n.js` ä»£ç æ›¿æ¢ç°æœ‰æ–‡ä»¶
2. æŒ‰ç…§è°ƒè¯•æŒ‡å—ä¸­çš„æ­¥éª¤3è¿›è¡ŒéªŒè¯
3. åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œè¯Šæ–­ä»£ç 

**å¦‚æœç¬¬ä¸€ä¼˜å…ˆçº§å¤±è´¥ï¼š**
1. å°è¯•å¤‡ç”¨æ–¹æ¡ˆ1ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
2. ä½¿ç”¨ `data-i18n` å±æ€§æ–¹å¼

**æœ€åæ‰‹æ®µï¼š**
1. ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ2ï¼ˆç›´æ¥æ–‡æœ¬æ›¿æ¢ï¼‰

### **ğŸ”‘ å…³é”®æˆåŠŸå› ç´ ï¼š**
- **æ­£ç¡®çš„åŠ è½½é¡ºåº**ï¼šå…ˆåŠ è½½i18nextåº“ï¼Œå†åŠ è½½é…ç½®
- **å¼‚æ­¥å¤„ç†**ï¼šç­‰å¾…i18nåˆå§‹åŒ–å®Œæˆå†æ›´æ–°DOM
- **é”™è¯¯å¤„ç†**ï¼šæä¾›é™çº§æœºåˆ¶å’Œè¯¦ç»†æ—¥å¿—

### **âš¡ ç«‹å³è¡ŒåŠ¨æ­¥éª¤ï¼š**

1. **å¤åˆ¶ç¬¬ä¸€ä¸ªå·¥ä»¶çš„ä»£ç ** åˆ°æ‚¨çš„ `i18n.js` æ–‡ä»¶
2. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜** å¹¶å¼ºåˆ¶åˆ·æ–°ï¼ˆCtrl+Shift+Rï¼‰
3. **æ£€æŸ¥æ§åˆ¶å°è¾“å‡º** æ˜¯å¦æ˜¾ç¤º "i18n initialized successfully"
4. **å¦‚æœä»æœ‰é—®é¢˜**ï¼ŒæŒ‰ç…§è°ƒè¯•æŒ‡å—é€æ­¥æ’æŸ¥

è¿™å¥—æ–¹æ¡ˆè§£å†³äº†æ‚¨å½“å‰é¢ä¸´çš„æ‰€æœ‰é—®é¢˜ï¼šç¿»è¯‘é”®æ˜¾ç¤ºã€æ§åˆ¶å°é”™è¯¯ã€å¼‚æ­¥åŠ è½½ç­‰ã€‚è¯·å…ˆå°è¯•ç¬¬ä¸€ä¸ªæ–¹æ¡ˆï¼Œå¦‚æœ‰é—®é¢˜éšæ—¶åé¦ˆï¼




import { t } from './i18n.js';export function getSymptomQuestions() {    return [        {             id: 'painLevel',             label: t('symptomAssessor.questions.painLevel.title'),             options: [                { value: 'mild', label: t('symptomAssessor.questions.painLevel.options.mild') },                { value: 'moderate', label: t('symptomAssessor.questions.painLevel.options.moderate') },                { value: 'severe', label: t('symptomAssessor.questions.painLevel.options.severe') },                { value: 'verySevere', label: t('symptomAssessor.questions.painLevel.options.verySevere') }            ]         },        {             id: 'painDuration',             label: t('symptomAssessor.questions.painDuration.title'),             options: [                { value: 'short', label: t('symptomAssessor.questions.painDuration.options.short') },                { value: 'medium', label: t('symptomAssessor.questions.painDuration.options.medium') },                { value: 'long', label: t('symptomAssessor.questions.painDuration.options.long') },                { value: 'variable', label: t('symptomAssessor.questions.painDuration.options.variable') }            ]        },        {             id: 'painLocation',             label: t('symptomAssessor.questions.painLocation.title'),             options: [                { value: 'lowerAbdomen', label: t('symptomAssessor.questions.painLocation.options.lowerAbdomen') },                { value: 'lowerBack', label: t('symptomAssessor.questions.painLocation.options.lowerBack') },                { value: 'upperThighs', label: t('symptomAssessor.questions.painLocation.options.upperThighs') },                { value: 'fullPelvis', label: t('symptomAssessor.questions.painLocation.options.fullPelvis') },                { value: 'sideFlank', label: t('symptomAssessor.questions.painLocation.options.sideFlank') }            ],             type: 'multi-select'         },        {             id: 'accompanyingSymptoms',             label: t('symptomAssessor.questions.accompanyingSymptoms.title'),             options: [                 { value: 'fatigue', label: t('symptomAssessor.questions.accompanyingSymptoms.options.fatigue') },                 { value: 'headache', label: t('symptomAssessor.questions.accompanyingSymptoms.options.headache') },                 { value: 'nausea', label: t('symptomAssessor.questions.accompanyingSymptoms.options.nausea') },                 { value: 'digestive', label: t('symptomAssessor.questions.accompanyingSymptoms.options.digestive') },                 { value: 'mood', label: t('symptomAssessor.questions.accompanyingSymptoms.options.mood') },                 { value: 'bloating', label: t('symptomAssessor.questions.accompanyingSymptoms.options.bloating') },                 { value: 'breastTenderness', label: t('symptomAssessor.questions.accompanyingSymptoms.options.breastTenderness') },                 { value: 'dizziness', label: t('symptomAssessor.questions.accompanyingSymptoms.options.dizziness') }            ],             type: 'multi-select'         },        {             id: 'reliefPreference',             label: t('impactAssessment.preference.title'),             options: [                { value: 'instant', label: t('impactAssessment.preference.options.instant') },                { value: 'natural', label: t('impactAssessment.preference.options.natural') },                { value: 'longTerm', label: t('impactAssessment.preference.options.longTerm') },                { value: 'medical', label: t('impactAssessment.preference.options.medical') }            ]        }    ];}export function getWorkplaceQuestions() {    return [        {             id: 'concentration',             label: t('workplaceAssessment.questions.concentration.title'),             options: [                { value: 'none', label: t('workplaceAssessment.questions.concentration.options.none') },                { value: 'slight', label: t('workplaceAssessment.questions.concentration.options.slight') },                { value: 'difficult', label: t('workplaceAssessment.questions.concentration.options.difficult') },                { value: 'impossible', label: t('workplaceAssessment.questions.concentration.options.impossible') }            ],             type: 'single-select'         },        {             id: 'absenteeism',             label: t('workplaceAssessment.questions.absenteeism.title'),             options: [                { value: 'never', label: t('workplaceAssessment.questions.absenteeism.options.never') },                { value: 'rarely', label: t('workplaceAssessment.questions.absenteeism.options.rarely') },                { value: 'sometimes', label: t('workplaceAssessment.questions.absenteeism.options.sometimes') },                { value: 'frequently', label: t('workplaceAssessment.questions.absenteeism.options.frequently') }            ],             type: 'single-select'         },        {             id: 'communication',             label: t('workplaceAssessment.questions.communication.title'),             options: [                { value: 'comfortable', label: t('workplaceAssessment.questions.communication.options.comfortable') },                { value: 'hesitant', label: t('workplaceAssessment.questions.communication.options.hesitant') },                { value: 'uncomfortable', label: t('workplaceAssessment.questions.communication.options.uncomfortable') },                { value: 'na', label: t('workplaceAssessment.questions.communication.options.na') }            ],             type: 'single-select'         },        {             id: 'support',             label: t('workplaceAssessment.questions.support.title'),             options: [                { value: 'flexHours', label: t('workplaceAssessment.questions.support.options.flexHours') },                { value: 'remoteWork', label: t('workplaceAssessment.questions.support.options.remoteWork') },                { value: 'restArea', label: t('workplaceAssessment.questions.support.options.restArea') },                { value: 'understanding', label: t('workplaceAssessment.questions.support.options.understanding') },                { value: 'leave', label: t('workplaceAssessment.questions.support.options.leave') },                { value: 'none', label: t('workplaceAssessment.questions.support.options.none') }            ],             type: 'multi-select'         }    ];}export function calculateSymptomImpact(answers) {    const { painLevel, painDuration, reliefPreference } = answers;    const isSevere = painLevel === 'severe' || painLevel === 'verySevere';    let summary = [];    const recommendations = { immediate: [], longTerm: [] };    summary.push(`${t('calculation.symptom.painLevel')}: ${t('symptomAssessor.questions.painLevel.options.' + painLevel)}`);    summary.push(`${t('calculation.symptom.duration')}: ${t('symptomAssessor.questions.painDuration.options.' + painDuration)}`);    if (painLevel === 'mild') {        recommendations.immediate.push(t('calculation.symptom.recs.mild.immediate1'));        recommendations.longTerm.push(t('calculation.symptom.recs.mild.longTerm1'));    } else if (painLevel === 'moderate') {        recommendations.immediate.push(t('calculation.symptom.recs.moderate.immediate1'));        recommendations.immediate.push(t('calculation.symptom.recs.moderate.immediate2'));        recommendations.longTerm.push(t('calculation.symptom.recs.moderate.longTerm1'));        recommendations.longTerm.push(t('calculation.symptom.recs.moderate.longTerm2'));    } else { // severe or verySevere        recommendations.immediate.push(t('calculation.symptom.recs.severe.immediate1'));        recommendations.immediate.push(t('calculation.symptom.recs.severe.immediate2'));        recommendations.longTerm.push(t('calculation.symptom.recs.severe.longTerm1'));        recommendations.longTerm.push(t('calculation.symptom.recs.severe.longTerm2'));    }    if (reliefPreference === 'natural') {        recommendations.immediate.unshift(t('calculation.symptom.recs.prefs.natural.immediate1'));        recommendations.longTerm.push(t('calculation.symptom.recs.prefs.natural.longTerm1'));    }    if (reliefPreference === 'medical') {        recommendations.longTerm.unshift(t('calculation.symptom.recs.prefs.medical.longTerm1'));    }    return {        isSevere,        summary,        recommendations    };}export function calculateWorkplaceImpact(answers) {    let score = 0;    const suggestions = [];    let profile = '';    if (answers.concentration) {        switch (answers.concentration) {            case 'none': score += 33; break;            case 'slight': score += 20; break;            case 'difficult': score += 10; break;            case 'impossible': score += 0; break;        }    }    if (answers.absenteeism) {        switch (answers.absenteeism) {            case 'never': score += 33; break;            case 'rarely': score += 20; break;            case 'sometimes': score += 10; break;            case 'frequently': score += 0; break;        }    }    if (answers.communication) {        switch (answers.communication) {            case 'comfortable': score += 34; break;            case 'hesitant': score += 15; break;            case 'uncomfortable': score += 5; break;            case 'na': score += 15; break;        }    }        score = Math.round(score);    if (score > 75) {        profile = t('calculation.workplace.profiles.supportive');        suggestions.push(t('calculation.workplace.suggestions.supportive1'));    } else if (score > 40) {        profile = t('calculation.workplace.profiles.adaptive');        suggestions.push(t('calculation.workplace.suggestions.adaptive1'));        suggestions.push(t('calculation.workplace.suggestions.adaptive2'));    } else {        profile = t('calculation.workplace.profiles.challenging');        suggestions.push(t('calculation.workplace.suggestions.challenging1'));        suggestions.push(t('calculation.workplace.suggestions.challenging2'));        suggestions.push(t('calculation.workplace.suggestions.challenging3'));    }        if (answers.communication === 'uncomfortable' || answers.communication === 'hesitant') {        suggestions.push(t('calculation.workplace.suggestions.communicationHelp'));    }    if (answers.support && answers.support.length > 0 && !answers.support.includes('none')) {        let supportText = t('calculation.workplace.suggestions.supportHeader');        const supportItems = [];        if (answers.support.includes('flexHours')) supportItems.push(t('workplaceAssessment.questions.support.options.flexHours'));        if (answers.support.includes('remoteWork')) supportItems.push(t('workplaceAssessment.questions.support.options.remoteWork'));        if (answers.support.includes('restArea')) supportItems.push(t('workplaceAssessment.questions.support.options.restArea'));        if (answers.support.includes('understanding')) supportItems.push(t('workplaceAssessment.questions.support.options.understanding'));        if (answers.support.includes('leave')) supportItems.push(t('workplaceAssessment.questions.support.options.leave'));                if(supportItems.length > 0) {            suggestions.push(supportText + supportItems.join(', ') + '.');        }    }    return {        score,        profile,        suggestions    };}
