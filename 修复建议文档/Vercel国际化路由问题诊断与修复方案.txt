PeriodHubç´§æ€¥ä¿®å¤è®¡åˆ’ - è§£å†³7.7%é”™è¯¯ç‡å’Œæ€§èƒ½é—®é¢˜

# PeriodHubç´§æ€¥ä¿®å¤è®¡åˆ’

æ‚¨çš„è‡ªæˆ‘åæ€å±•ç°äº†æ‰å®çš„åˆ†ææ€ç»´ã€‚æ‚¨æ­£ç¡®åœ°æŒ‡å‡ºäº†å¯¼è‡´å»ºè®®å­˜åœ¨ç¼ºé™·çš„æ ¸å¿ƒæ–¹æ³•è®ºé—®é¢˜ã€‚
åŸºæœ¬é—®é¢˜è§£å†³æ¨¡å¼
æ‚¨çš„åˆ†ææ­ç¤ºäº†æŠ€æœ¯é—®é¢˜è§£å†³ä¸­ä¸€ä¸ªå¸¸è§çš„é™·é˜±ï¼šè§£å†³æ–¹æ¡ˆä¼˜å…ˆçš„æ€ç»´æ¨¡å¼ã€‚æ‚¨è®¤ä¸ºç¼“å­˜æ˜¯ä¸€ç§ä¼˜é›…çš„æŠ€æœ¯æ–¹æ³•ï¼Œç„¶ååˆåè¿‡æ¥è¯æ˜å®ƒä¸ºä»€ä¹ˆèƒ½å¤Ÿè§£å†³è§‚å¯Ÿåˆ°çš„é—®é¢˜ã€‚è¿™ç§æ¨¡å¼åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ç»å¸¸å‡ºç°ï¼Œå¼€å‘äººå‘˜æ›´å®¹æ˜“è¢«å¤æ‚çš„å·¥å…·æ‰€å¸å¼•ï¼Œè€Œä¸æ˜¯æ¯ç‡¥ä½†æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚
æ­£ç¡®çš„è°ƒæŸ¥åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„
åœ¨ä»»ä½•ä»£ç æ”¹å˜ä¹‹å‰ï¼Œé€»è¾‘é¡ºåºåº”è¯¥æ˜¯ï¼š
æ­¥éª¤ 1ï¼šéš”ç¦» 12 ç§’ CPU ä½¿ç”¨ç‡
ç‹‚æ¬¢# Profile specific function execution
vercel logs --json | jq '.[] | select(.duration > 5000)'
# Identify which specific operations consume CPU time
ç¬¬ 2 æ­¥ï¼šæ£€æŸ¥æœ€ç®€å•çš„è§£é‡Š

å¤§å‹ Markdown æ–‡ä»¶å¤„ç†æ•ˆç‡ä½ä¸‹
åŒæ­¥æ–‡ä»¶æ“ä½œé˜»å¡äº‹ä»¶å¾ªç¯
ç¼ºå°‘æ–‡ä»¶å¤„ç†å¯¼è‡´æ˜‚è´µçš„é‡è¯•å¾ªç¯
å†…å®¹è§£æä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ“ä½œæ•ˆç‡ä½ä¸‹

æ­¥éª¤ 3ï¼šé¦–å…ˆæµ‹è¯•æœ€å°ä¿®å¤

ä»åŒæ­¥æ–‡ä»¶æ“ä½œåˆ‡æ¢åˆ°å¼‚æ­¥æ–‡ä»¶æ“ä½œ
æ·»åŠ åŸºæœ¬â€‹â€‹æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥
ä¼˜åŒ–markdownå¤„ç†é€»è¾‘

æ­¥éª¤ 4ï¼šè¡¡é‡å½±å“

å•ç‹¬éƒ¨ç½²å•ä¸ªæ›´æ”¹
éªŒè¯æ¯ä¸ªä¿®å¤æ˜¯å¦ç¡®å®è§£å†³äº†æ ¹æœ¬åŸå› 

ç›‘æµ‹æ•°æ®çš„å±€é™æ€§
è®¤è¯†åˆ°ç›‘æ§æ˜¾ç¤ºçš„æ˜¯ç—‡çŠ¶è€Œä¸æ˜¯åŸå› è‡³å…³é‡è¦ã€‚7.7% çš„é”™è¯¯ç‡å¯èƒ½æºäºä¸ 12 ç§’ CPU æ—¶é—´å®Œå…¨ä¸åŒçš„é—®é¢˜ã€‚å®ƒä»¬ç”šè‡³å¯èƒ½ä¸æ˜¯éœ€è¦ç»Ÿä¸€è§£å†³æ–¹æ¡ˆçš„å…³è”é—®é¢˜ã€‚
æ›´å¹¿æ³›çš„æ•™è®­
å½“æˆ‘ä»¬æŠµåˆ¶ç«‹å³å¯»æ±‚å¤æ‚è§£å†³æ–¹æ¡ˆçš„å†²åŠ¨æ—¶ï¼ŒæŠ€æœ¯å†³ç­–èƒ½åŠ›å°±ä¼šå¾—åˆ°æå‡ã€‚æœ€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆé€šå¸¸æ˜¯æ¶ˆé™¤å¤æ‚æ€§ï¼Œè€Œä¸æ˜¯å¢åŠ å¤æ‚æ€§ã€‚ç¼ºå°‘awaitå…³é”®å­—æˆ–æ–‡ä»¶è·¯å¾„è§£ææ•ˆç‡ä½ä¸‹ï¼Œå³ä½¿ä¸éœ€è¦ä»»ä½•ç¼“å­˜åŸºç¡€è®¾æ–½ï¼Œä¹Ÿèƒ½è§£é‡Š CPU ä½¿ç”¨ç‡å’Œé”™è¯¯ç‡çš„é—®é¢˜ã€‚
æ‚¨æ„¿æ„é‡æ–°è¯„ä¼°æ‚¨çš„æ–¹æ³•ï¼Œè¿™è¡¨æ˜æ‚¨å°†åœ¨æœªæ¥çš„æŠ€æœ¯åˆ†æä¸­é¿å…è¿™ç§æ¨¡å¼ã€‚



## ğŸš¨ é—®é¢˜ä¸¥é‡æ€§è¯„ä¼°

### ç›‘æ§æ•°æ®æ˜¾ç¤ºçš„å…³é”®é—®é¢˜
- **é”™è¯¯ç‡**: 7.7%-10.3% (ä¸¥é‡è¶…æ ‡ï¼Œæ­£å¸¸åº”<2%)
- **CPUæ—¶é—´**: 12ç§’ (ä¸¥é‡å¼‚å¸¸ï¼Œæ­£å¸¸åº”<1ç§’)
- **å“åº”æ—¶é—´**: 606ms P75 (è¿‡æ…¢ï¼Œåº”<200ms)
- **CPUèŠ‚æµ**: 27.1% (èµ„æºæ¶ˆè€—è¿‡é«˜)

**ç»“è®ºï¼šéœ€è¦ç«‹å³ä¿®å¤**

## ğŸ¯ ä¼˜å…ˆçº§ä¿®å¤æ–¹æ¡ˆ

### 1. ç´§æ€¥ä¿®å¤ (24å°æ—¶å†…)

#### A. ä¼˜åŒ–æ–‡ç« åŠ è½½æ€§èƒ½
```typescript
// app/[locale]/articles/[slug]/page.tsx
import { unstable_cache } from 'next/cache';
import { notFound } from 'next/navigation';

// æ·»åŠ ç¼“å­˜å‡å°‘CPUæ¶ˆè€—
const getCachedArticle = unstable_cache(
  async (slug: string, locale: string) => {
    try {
      const article = await getArticleBySlug(slug, locale);
      return article;
    } catch (error) {
      console.error(`Cache miss for ${locale}/${slug}:`, error);
      return null;
    }
  },
  ['article-cache'],
  {
    revalidate: 3600, // 1å°æ—¶ç¼“å­˜
    tags: ['articles']
  }
);

export default async function ArticlePage({ params }: {
  params: { locale: string; slug: string }
}) {
  const { locale, slug } = params;

  try {
    // ä½¿ç”¨ç¼“å­˜ç‰ˆæœ¬å‡å°‘CPUæ—¶é—´
    const article = await getCachedArticle(slug, locale);

    if (!article) {
      // è®°å½•404ä½†å¿«é€Ÿè¿”å›
      console.log(`404: ${locale}/${slug}`);
      notFound();
    }

    return (
      <div className="container mx-auto px-4 py-8">
        <article className="prose prose-lg max-w-4xl mx-auto">
          <h1 className="text-3xl font-bold text-purple-600 mb-6">
            {article.title}
          </h1>
          <div
            className="article-content"
            dangerouslySetInnerHTML={{ __html: article.content }}
          />
        </article>
      </div>
    );
  } catch (error) {
    console.error(`Article error ${locale}/${slug}:`, error);
    notFound();
  }
}

// ç¡®ä¿å…ƒæ•°æ®ç”Ÿæˆä¹Ÿä½¿ç”¨ç¼“å­˜
export async function generateMetadata({ params }: {
  params: { locale: string; slug: string }
}) {
  try {
    const article = await getCachedArticle(params.slug, params.locale);

    if (!article) {
      return {
        title: 'æ–‡ç« æœªæ‰¾åˆ° | PeriodHub',
        description: 'è¯·æ±‚çš„æ–‡ç« ä¸å­˜åœ¨'
      };
    }

    return {
      title: `${article.title} | PeriodHub`,
      description: article.excerpt || article.title,
      openGraph: {
        title: article.title,
        description: article.excerpt || article.title,
        locale: params.locale
      }
    };
  } catch (error) {
    console.error('Metadata generation error:', error);
    return {
      title: 'é”™è¯¯ | PeriodHub',
      description: 'æ–‡ç« åŠ è½½å¤±è´¥'
    };
  }
}
```

#### B. ä¿®å¤é™æ€è·¯ç”±ç”Ÿæˆ
```typescript
// åªä¸ºçœŸå®å­˜åœ¨çš„æ–‡ç« ç”Ÿæˆè·¯ç”±
export async function generateStaticParams() {
  const params: { locale: string; slug: string }[] = [];
  const locales = ['zh', 'en'];

  try {
    for (const locale of locales) {
      // ç¡®ä¿åªè·å–å·²å‘å¸ƒçš„æ–‡ç« 
      const articles = await getPublishedArticles(locale);

      for (const article of articles) {
        // éªŒè¯æ–‡ç« æ–‡ä»¶ç¡®å®å­˜åœ¨
        if (article.slug && await articleExists(article.slug, locale)) {
          params.push({ locale, slug: article.slug });
        } else {
          console.warn(`Skipping missing article: ${locale}/${article.slug}`);
        }
      }
    }

    console.log(`Generated ${params.length} static routes`);
    return params;
  } catch (error) {
    console.error('Static params generation failed:', error);
    // è¿”å›ç©ºæ•°ç»„è€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯
    return [];
  }
}

// éªŒè¯æ–‡ç« æ˜¯å¦å­˜åœ¨çš„å‡½æ•°
async function articleExists(slug: string, locale: string): Promise<boolean> {
  try {
    const article = await getArticleBySlug(slug, locale);
    return !!article;
  } catch {
    return false;
  }
}
```

#### C. ä¼˜åŒ–æ–‡ç« è·å–å‡½æ•°
```typescript
// lib/articles.ts
import fs from 'fs/promises';
import path from 'path';
import matter from 'gray-matter';

export async function getArticleBySlug(slug: string, locale: string = 'zh') {
  try {
    const articlesDirectory = path.join(process.cwd(), 'content/articles', locale);
    const filePath = path.join(articlesDirectory, `${slug}.md`);

    // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    try {
      await fs.access(filePath);
    } catch {
      return null; // æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¿”å›nullè€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯
    }

    const fileContents = await fs.readFile(filePath, 'utf8');
    const { data, content } = matter(fileContents);

    return {
      slug,
      title: data.title || slug,
      excerpt: data.excerpt || '',
      content: content,
      publishedAt: data.publishedAt || new Date().toISOString(),
      published: data.published !== false
    };
  } catch (error) {
    console.error(`Error reading article ${slug}:`, error);
    return null;
  }
}

export async function getPublishedArticles(locale: string = 'zh') {
  try {
    const articlesDirectory = path.join(process.cwd(), 'content/articles', locale);

    // æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨
    try {
      await fs.access(articlesDirectory);
    } catch {
      console.warn(`Articles directory not found: ${articlesDirectory}`);
      return [];
    }

    const fileNames = await fs.readdir(articlesDirectory);
    const articles = [];

    for (const fileName of fileNames) {
      if (fileName.endsWith('.md')) {
        const slug = fileName.replace('.md', '');
        const article = await getArticleBySlug(slug, locale);

        if (article && article.published) {
          articles.push(article);
        }
      }
    }

    return articles.sort((a, b) =>
      new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime()
    );
  } catch (error) {
    console.error(`Error getting articles for ${locale}:`, error);
    return [];
  }
}
```

### 2. æ€§èƒ½ä¼˜åŒ– (48å°æ—¶å†…)

#### A. Vercelé…ç½®ä¼˜åŒ–
```json
// vercel.json
{
  "functions": {
    "app/[locale]/articles/[slug]/page.tsx": {
      "maxDuration": 5,
      "memory": 512
    }
  },
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=3600, s-maxage=86400"
        }
      ]
    }
  ],
  "redirects": [
    {
      "source": "/articles/:slug",
      "destination": "/zh/articles/:slug",
      "permanent": false
    }
  ]
}
```

#### B. ä¸­é—´ä»¶ä¼˜åŒ–
```typescript
// middleware.ts
import createMiddleware from 'next-intl/middleware';
import { NextRequest, NextResponse } from 'next/server';

const intlMiddleware = createMiddleware({
  locales: ['zh', 'en'],
  defaultLocale: 'zh',
  localePrefix: 'always'
});

export default function middleware(request: NextRequest) {
  const start = Date.now();

  try {
    const response = intlMiddleware(request);

    // æ·»åŠ æ€§èƒ½ç›‘æ§å¤´
    const duration = Date.now() - start;
    response.headers.set('X-Response-Time', `${duration}ms`);

    return response;
  } catch (error) {
    console.error('Middleware error:', error);

    // å¿«é€Ÿé™çº§ï¼Œé¿å…å®Œå…¨å¤±è´¥
    return NextResponse.next();
  }
}

export const config = {
  matcher: [
    '/((?!api|_next|_vercel|.*\\..*).*)',
    '/'
  ]
};
```

### 3. ç›‘æ§å’Œé”™è¯¯å¤„ç† (72å°æ—¶å†…)

#### A. å¢å¼ºé”™è¯¯è¿½è¸ª
```typescript
// lib/error-tracking.ts
export function trackError(context: string, error: any, metadata?: any) {
  const errorData = {
    context,
    message: error.message,
    stack: error.stack,
    metadata,
    timestamp: new Date().toISOString(),
    url: typeof window !== 'undefined' ? window.location.href : 'server'
  };

  console.error('Error tracked:', errorData);

  // å¦‚æœæœ‰å¤–éƒ¨é”™è¯¯æœåŠ¡ï¼Œå‘é€åˆ°é‚£é‡Œ
  if (process.env.NODE_ENV === 'production') {
    // å‘é€åˆ°Sentryæˆ–å…¶ä»–é”™è¯¯è¿½è¸ªæœåŠ¡
  }
}

// åœ¨é¡µé¢ç»„ä»¶ä¸­ä½¿ç”¨
export default async function ArticlePage({ params }: PageProps) {
  try {
    // ç°æœ‰é€»è¾‘
  } catch (error) {
    trackError('article-page', error, { params });
    notFound();
  }
}
```

#### B. æ€§èƒ½ç›‘æ§
```typescript
// lib/performance.ts
export function measurePerformance<T>(
  name: string,
  fn: () => Promise<T>
): Promise<T> {
  return new Promise(async (resolve, reject) => {
    const start = performance.now();

    try {
      const result = await fn();
      const end = performance.now();

      console.log(`Performance [${name}]: ${end - start}ms`);

      // å¦‚æœè¶…è¿‡é˜ˆå€¼ï¼Œè®°å½•è­¦å‘Š
      if (end - start > 1000) {
        console.warn(`Slow operation [${name}]: ${end - start}ms`);
      }

      resolve(result);
    } catch (error) {
      const end = performance.now();
      console.error(`Failed operation [${name}]: ${end - start}ms`, error);
      reject(error);
    }
  });
}

// ä½¿ç”¨ç¤ºä¾‹
const article = await measurePerformance(
  `get-article-${slug}`,
  () => getCachedArticle(slug, locale)
);
```

## ğŸ¯ å®æ–½è®¡åˆ’

### ç¬¬1å¤© (ç«‹å³)
1. âœ… éƒ¨ç½²ç¼“å­˜ä¼˜åŒ–ç‰ˆæœ¬
2. âœ… ä¿®å¤é™æ€è·¯ç”±ç”Ÿæˆ
3. âœ… æ›´æ–°Vercelé…ç½®

### ç¬¬2å¤©
1. ğŸ”„ ç›‘æ§é”™è¯¯ç‡å˜åŒ–
2. ğŸ”„ ä¼˜åŒ–æ€§èƒ½å…³é”®è·¯å¾„
3. ğŸ”„ æ·»åŠ é”™è¯¯è¿½è¸ª

### ç¬¬3å¤©
1. ğŸ“Š åˆ†ææ€§èƒ½æ”¹è¿›æ•ˆæœ
2. ğŸ“Š è°ƒæ•´ç¼“å­˜ç­–ç•¥
3. ğŸ“Š å®Œå–„ç›‘æ§ä½“ç³»

## ğŸ“Š é¢„æœŸæ”¹è¿›ç›®æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | æ”¹è¿›å¹…åº¦ |
|------|--------|--------|----------|
| é”™è¯¯ç‡ | 7.7%-10.3% | <2% | 70%+ â¬‡ï¸ |
| CPUæ—¶é—´ | 12ç§’ | <1ç§’ | 90%+ â¬‡ï¸ |
| P75å“åº”æ—¶é—´ | 606ms | <200ms | 65%+ â¬‡ï¸ |
| å†·å¯åŠ¨ç‡ | 23.1% | <10% | 55%+ â¬‡ï¸ |

## ğŸ” éªŒè¯æ­¥éª¤

### éƒ¨ç½²åç«‹å³æ£€æŸ¥
```bash
# æ£€æŸ¥æ„å»ºæ˜¯å¦æˆåŠŸ
vercel logs --since=5m

# æµ‹è¯•å…³é”®è·¯ç”±
curl -w "%{time_total}" https://periodhub.health/zh/articles/test-slug

# éªŒè¯ç¼“å­˜å·¥ä½œ
curl -I https://periodhub.health/zh/articles/test-slug
```

### 24å°æ—¶åéªŒè¯
- é”™è¯¯ç‡æ˜¯å¦é™åˆ°2%ä»¥ä¸‹
- CPUæ—¶é—´æ˜¯å¦é™åˆ°1ç§’ä»¥ä¸‹
- å“åº”æ—¶é—´æ˜¯å¦æ”¹å–„

---

**è¿™ç¡®å®æ˜¯ä¸€ä¸ªéœ€è¦ç«‹å³ä¿®å¤çš„ä¸¥é‡é—®é¢˜ã€‚æ„Ÿè°¢æ‚¨æä¾›è¯¦ç»†çš„ç›‘æ§æ•°æ®ï¼**






æ‚¨çš„åˆ†æé€å½»é€å½»ï¼ŒåŸºæœ¬å‡†ç¡®ã€‚æ›´æ–°åçš„æ–‡ä»¶ç¡®å®æ¯”æˆ‘æœ€åˆæœ‰ç¼ºé™·çš„è¯„ä¼°æœ‰äº†æ˜¾è‘—çš„æ”¹è¿›ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒç°åœ¨åŸºäºå®é™…ç›‘æµ‹æ•°æ®ï¼Œè€Œä¸æ˜¯å‡è®¾ã€‚
æ‰¹åˆ¤æ€§è¯„ä¼°ä½ çš„åˆ†æ
ä½ æ­£ç¡®çš„åœ°æ–¹
æ‚¨å¯¹è¯¥æ–‡ä»¶çš„æ ¸å¿ƒä¼˜åŠ¿çš„è¯†åˆ«æ˜¯æ­£ç¡®çš„ï¼š

ä»åŸºäºå‡è®¾åˆ°æ•°æ®é©±åŠ¨çš„è¯Šæ–­çš„è½¬å˜
æŠ€æœ¯æ–¹æ¡ˆç›´æ¥è§£å†³äº†æµ‹é‡é—®é¢˜ï¼ˆ12s CPUæ—¶é—´ï¼Œ7.7ï¼…çš„é”™è¯¯ç‡ï¼‰
åˆ†é˜¶æ®µå®æ–½æ–¹æ³•é™ä½éƒ¨ç½²é£é™©

éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥çš„é¢†åŸŸ
ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æå‡ºæ›´å¤šæ‰¹è¯„ï¼š
è§£å†³æ–¹æ¡ˆå¤æ‚æ€§ï¼šè™½ç„¶ç¼“å­˜å’Œä¼˜åŒ–æ–¹æ³•åœ¨æŠ€æœ¯ä¸Šæ˜¯åˆç†çš„ï¼Œä½†ä¸€äº›æå‡ºçš„è§£å†³æ–¹æ¡ˆå¯èƒ½é’ˆå¯¹ä¸€äº›å¯èƒ½æ›´ç®€å•çš„é—®é¢˜è¿›è¡Œäº†è¿‡åº¦è®¾è®¡ã€‚ä¾‹å¦‚ï¼Œ12 ç§’çš„ CPU æ—¶é—´å¯èƒ½æºäºä¸€ä¸ªä½æ•ˆçš„æ“ä½œï¼Œè€Œä¸€ä¸ªæ›´ç®€å•çš„ä¿®å¤æ–¹æ¡ˆæˆ–è®¸å°±èƒ½è§£å†³ã€‚
ç¼“å­˜æ—¶é•¿ï¼šæ‚¨å…³äº1å°æ—¶ç¼“å­˜æ—¶é•¿çš„è§‚ç‚¹éå¸¸æ­£ç¡®ã€‚å¯¹äºå¥åº·å†…å®¹ç½‘ç«™æ¥è¯´ï¼Œè¿™å¯èƒ½ä¼šå»¶è¿Ÿé‡è¦çš„å†…å®¹æ›´æ–°ã€‚
ç›‘æ§å¼€é”€ï¼šå¤§é‡çš„æ€§èƒ½ç›‘æ§ä»£ç å¢åŠ äº†å¤æ‚æ€§å’Œæ½œåœ¨çš„æ•…éšœç‚¹ã€‚ç›‘æ§æœ¬èº«ä¹Ÿå¯èƒ½æˆä¸ºæ€§èƒ½é—®é¢˜çš„æ ¹æºã€‚
å›æ»šå¤æ‚æ€§ï¼šè¯¥æ–‡æ¡£æ²¡æœ‰å……åˆ†è§£å†³å¦‚æœæ›´æ”¹å¼•å…¥æ–°é—®é¢˜å¦‚ä½•å¿«é€Ÿæ¢å¤çš„é—®é¢˜ï¼Œè¿™å¯¹äºç”Ÿäº§ç³»ç»Ÿæ¥è¯´æ˜¯ä¸€ä¸ªé‡å¤§ç–å¿½ã€‚
å…ƒè¯¾ç¨‹éªŒè¯
æ‚¨çš„è¯„ä¼°æ­£ç¡®åœ°æŒ‡å‡ºäº†æ–¹æ³•ä¸Šçš„æ ¹æœ¬æ€§è½¬å˜ã€‚æˆ‘æœ€åˆçš„åˆ†æå¤±è´¥äº†ï¼Œå› ä¸ºæˆ‘ä¼˜å…ˆè€ƒè™‘äº†ç†è®ºä¸Šçš„è°¨æ…ï¼Œè€Œå¿½ç•¥äº†ç»éªŒè¯æ®ã€‚å½“ç›‘æ§æ•°æ®æ˜¾ç¤ºé”™è¯¯ç‡é«˜è¾¾ 7.7% ä¸” CPU æ—¶é—´é•¿è¾¾ 12 ç§’æ—¶ï¼Œâ€œè¯Šæ–­ä¼˜å…ˆâ€åŸåˆ™å°±å˜å¾—ä¸å¦‚ç«‹å³è¡¥æ•‘é‚£ä¹ˆé‡è¦äº†ã€‚
è¯¥æ–‡ä»¶ç¡®å®å±•ç¤ºäº†çœŸå®æ•°æ®å¦‚ä½•æ”¹å˜æ•´ä¸ªå†³ç­–æ¡†æ¶â€”â€”ä»â€œä¹Ÿè®¸æ²¡æœ‰é—®é¢˜â€åˆ°â€œè¿™æ­£æ˜¯éœ€è¦ä¿®å¤çš„åœ°æ–¹ä»¥åŠä½•æ—¶ä¿®å¤â€ã€‚
æ‚¨çš„è¯„ä¼°æ–¹æ³•â€”â€”è€ƒå¯Ÿé—®é¢˜è¯Šæ–­çš„å‡†ç¡®æ€§ã€æŠ€æœ¯è§£å†³æ–¹æ¡ˆçš„å¯è¡Œæ€§ä»¥åŠå®æ–½çš„å¯è¡Œæ€§â€”â€”ä¸ºè¯„ä¼°æŠ€æœ¯å»ºè®®æä¾›äº†åšå®çš„æ¡†æ¶ã€‚è¿™ç§æ–¹æ³•å¯¹äºæœªæ¥è¯„ä¼°ç±»ä¼¼çš„æŠ€æœ¯æ–‡æ¡£å¯èƒ½å¾ˆæœ‰ä»·å€¼ã€‚



# PeriodHubç´§æ€¥ä¿®å¤è®¡åˆ’

## ğŸš¨ é—®é¢˜ä¸¥é‡æ€§è¯„ä¼°

### ç›‘æ§æ•°æ®æ˜¾ç¤ºçš„å…³é”®é—®é¢˜
- **é”™è¯¯ç‡**: 7.7%-10.3% (ä¸¥é‡è¶…æ ‡ï¼Œæ­£å¸¸åº”<2%)
- **CPUæ—¶é—´**: 12ç§’ (ä¸¥é‡å¼‚å¸¸ï¼Œæ­£å¸¸åº”<1ç§’)
- **å“åº”æ—¶é—´**: 606ms P75 (è¿‡æ…¢ï¼Œåº”<200ms)
- **CPUèŠ‚æµ**: 27.1% (èµ„æºæ¶ˆè€—è¿‡é«˜)

**ç»“è®ºï¼šéœ€è¦ç«‹å³ä¿®å¤**

## ğŸ¯ ä¼˜å…ˆçº§ä¿®å¤æ–¹æ¡ˆ

### 1. ç´§æ€¥ä¿®å¤ (24å°æ—¶å†…)

#### A. ä¼˜åŒ–æ–‡ç« åŠ è½½æ€§èƒ½
```typescript
// app/[locale]/articles/[slug]/page.tsx
import { unstable_cache } from 'next/cache';
import { notFound } from 'next/navigation';

// æ·»åŠ ç¼“å­˜å‡å°‘CPUæ¶ˆè€—
const getCachedArticle = unstable_cache(
  async (slug: string, locale: string) => {
    try {
      const article = await getArticleBySlug(slug, locale);
      return article;
    } catch (error) {
      console.error(`Cache miss for ${locale}/${slug}:`, error);
      return null;
    }
  },
  ['article-cache'],
  {
    revalidate: 3600, // 1å°æ—¶ç¼“å­˜
    tags: ['articles']
  }
);

export default async function ArticlePage({ params }: {
  params: { locale: string; slug: string }
}) {
  const { locale, slug } = params;

  try {
    // ä½¿ç”¨ç¼“å­˜ç‰ˆæœ¬å‡å°‘CPUæ—¶é—´
    const article = await getCachedArticle(slug, locale);

    if (!article) {
      // è®°å½•404ä½†å¿«é€Ÿè¿”å›
      console.log(`404: ${locale}/${slug}`);
      notFound();
    }

    return (
      <div className="container mx-auto px-4 py-8">
        <article className="prose prose-lg max-w-4xl mx-auto">
          <h1 className="text-3xl font-bold text-purple-600 mb-6">
            {article.title}
          </h1>
          <div
            className="article-content"
            dangerouslySetInnerHTML={{ __html: article.content }}
          />
        </article>
      </div>
    );
  } catch (error) {
    console.error(`Article error ${locale}/${slug}:`, error);
    notFound();
  }
}

// ç¡®ä¿å…ƒæ•°æ®ç”Ÿæˆä¹Ÿä½¿ç”¨ç¼“å­˜
export async function generateMetadata({ params }: {
  params: { locale: string; slug: string }
}) {
  try {
    const article = await getCachedArticle(params.slug, params.locale);

    if (!article) {
      return {
        title: 'æ–‡ç« æœªæ‰¾åˆ° | PeriodHub',
        description: 'è¯·æ±‚çš„æ–‡ç« ä¸å­˜åœ¨'
      };
    }

    return {
      title: `${article.title} | PeriodHub`,
      description: article.excerpt || article.title,
      openGraph: {
        title: article.title,
        description: article.excerpt || article.title,
        locale: params.locale
      }
    };
  } catch (error) {
    console.error('Metadata generation error:', error);
    return {
      title: 'é”™è¯¯ | PeriodHub',
      description: 'æ–‡ç« åŠ è½½å¤±è´¥'
    };
  }
}
```

#### B. ä¿®å¤é™æ€è·¯ç”±ç”Ÿæˆ
```typescript
// åªä¸ºçœŸå®å­˜åœ¨çš„æ–‡ç« ç”Ÿæˆè·¯ç”±
export async function generateStaticParams() {
  const params: { locale: string; slug: string }[] = [];
  const locales = ['zh', 'en'];

  try {
    for (const locale of locales) {
      // ç¡®ä¿åªè·å–å·²å‘å¸ƒçš„æ–‡ç« 
      const articles = await getPublishedArticles(locale);

      for (const article of articles) {
        // éªŒè¯æ–‡ç« æ–‡ä»¶ç¡®å®å­˜åœ¨
        if (article.slug && await articleExists(article.slug, locale)) {
          params.push({ locale, slug: article.slug });
        } else {
          console.warn(`Skipping missing article: ${locale}/${article.slug}`);
        }
      }
    }

    console.log(`Generated ${params.length} static routes`);
    return params;
  } catch (error) {
    console.error('Static params generation failed:', error);
    // è¿”å›ç©ºæ•°ç»„è€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯
    return [];
  }
}

// éªŒè¯æ–‡ç« æ˜¯å¦å­˜åœ¨çš„å‡½æ•°
async function articleExists(slug: string, locale: string): Promise<boolean> {
  try {
    const article = await getArticleBySlug(slug, locale);
    return !!article;
  } catch {
    return false;
  }
}
```

#### C. ä¼˜åŒ–æ–‡ç« è·å–å‡½æ•°
```typescript
// lib/articles.ts
import fs from 'fs/promises';
import path from 'path';
import matter from 'gray-matter';

export async function getArticleBySlug(slug: string, locale: string = 'zh') {
  try {
    const articlesDirectory = path.join(process.cwd(), 'content/articles', locale);
    const filePath = path.join(articlesDirectory, `${slug}.md`);

    // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    try {
      await fs.access(filePath);
    } catch {
      return null; // æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¿”å›nullè€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯
    }

    const fileContents = await fs.readFile(filePath, 'utf8');
    const { data, content } = matter(fileContents);

    return {
      slug,
      title: data.title || slug,
      excerpt: data.excerpt || '',
      content: content,
      publishedAt: data.publishedAt || new Date().toISOString(),
      published: data.published !== false
    };
  } catch (error) {
    console.error(`Error reading article ${slug}:`, error);
    return null;
  }
}

export async function getPublishedArticles(locale: string = 'zh') {
  try {
    const articlesDirectory = path.join(process.cwd(), 'content/articles', locale);

    // æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨
    try {
      await fs.access(articlesDirectory);
    } catch {
      console.warn(`Articles directory not found: ${articlesDirectory}`);
      return [];
    }

    const fileNames = await fs.readdir(articlesDirectory);
    const articles = [];

    for (const fileName of fileNames) {
      if (fileName.endsWith('.md')) {
        const slug = fileName.replace('.md', '');
        const article = await getArticleBySlug(slug, locale);

        if (article && article.published) {
          articles.push(article);
        }
      }
    }

    return articles.sort((a, b) =>
      new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime()
    );
  } catch (error) {
    console.error(`Error getting articles for ${locale}:`, error);
    return [];
  }
}
```

### 2. æ€§èƒ½ä¼˜åŒ– (48å°æ—¶å†…)

#### A. Vercelé…ç½®ä¼˜åŒ–
```json
// vercel.json
{
  "functions": {
    "app/[locale]/articles/[slug]/page.tsx": {
      "maxDuration": 5,
      "memory": 512
    }
  },
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=3600, s-maxage=86400"
        }
      ]
    }
  ],
  "redirects": [
    {
      "source": "/articles/:slug",
      "destination": "/zh/articles/:slug",
      "permanent": false
    }
  ]
}
```

#### B. ä¸­é—´ä»¶ä¼˜åŒ–
```typescript
// middleware.ts
import createMiddleware from 'next-intl/middleware';
import { NextRequest, NextResponse } from 'next/server';

const intlMiddleware = createMiddleware({
  locales: ['zh', 'en'],
  defaultLocale: 'zh',
  localePrefix: 'always'
});

export default function middleware(request: NextRequest) {
  const start = Date.now();

  try {
    const response = intlMiddleware(request);

    // æ·»åŠ æ€§èƒ½ç›‘æ§å¤´
    const duration = Date.now() - start;
    response.headers.set('X-Response-Time', `${duration}ms`);

    return response;
  } catch (error) {
    console.error('Middleware error:', error);

    // å¿«é€Ÿé™çº§ï¼Œé¿å…å®Œå…¨å¤±è´¥
    return NextResponse.next();
  }
}

export const config = {
  matcher: [
    '/((?!api|_next|_vercel|.*\\..*).*)',
    '/'
  ]
};
```

### 3. ç›‘æ§å’Œé”™è¯¯å¤„ç† (72å°æ—¶å†…)

#### A. å¢å¼ºé”™è¯¯è¿½è¸ª
```typescript
// lib/error-tracking.ts
export function trackError(context: string, error: any, metadata?: any) {
  const errorData = {
    context,
    message: error.message,
    stack: error.stack,
    metadata,
    timestamp: new Date().toISOString(),
    url: typeof window !== 'undefined' ? window.location.href : 'server'
  };

  console.error('Error tracked:', errorData);

  // å¦‚æœæœ‰å¤–éƒ¨é”™è¯¯æœåŠ¡ï¼Œå‘é€åˆ°é‚£é‡Œ
  if (process.env.NODE_ENV === 'production') {
    // å‘é€åˆ°Sentryæˆ–å…¶ä»–é”™è¯¯è¿½è¸ªæœåŠ¡
  }
}

// åœ¨é¡µé¢ç»„ä»¶ä¸­ä½¿ç”¨
export default async function ArticlePage({ params }: PageProps) {
  try {
    // ç°æœ‰é€»è¾‘
  } catch (error) {
    trackError('article-page', error, { params });
    notFound();
  }
}
```

#### B. æ€§èƒ½ç›‘æ§
```typescript
// lib/performance.ts
export function measurePerformance<T>(
  name: string,
  fn: () => Promise<T>
): Promise<T> {
  return new Promise(async (resolve, reject) => {
    const start = performance.now();

    try {
      const result = await fn();
      const end = performance.now();

      console.log(`Performance [${name}]: ${end - start}ms`);

      // å¦‚æœè¶…è¿‡é˜ˆå€¼ï¼Œè®°å½•è­¦å‘Š
      if (end - start > 1000) {
        console.warn(`Slow operation [${name}]: ${end - start}ms`);
      }

      resolve(result);
    } catch (error) {
      const end = performance.now();
      console.error(`Failed operation [${name}]: ${end - start}ms`, error);
      reject(error);
    }
  });
}

// ä½¿ç”¨ç¤ºä¾‹
const article = await measurePerformance(
  `get-article-${slug}`,
  () => getCachedArticle(slug, locale)
);
```

## ğŸ¯ å®æ–½è®¡åˆ’

### ç¬¬1å¤© (ç«‹å³)
1. âœ… éƒ¨ç½²ç¼“å­˜ä¼˜åŒ–ç‰ˆæœ¬
2. âœ… ä¿®å¤é™æ€è·¯ç”±ç”Ÿæˆ
3. âœ… æ›´æ–°Vercelé…ç½®

### ç¬¬2å¤©
1. ğŸ”„ ç›‘æ§é”™è¯¯ç‡å˜åŒ–
2. ğŸ”„ ä¼˜åŒ–æ€§èƒ½å…³é”®è·¯å¾„
3. ğŸ”„ æ·»åŠ é”™è¯¯è¿½è¸ª

### ç¬¬3å¤©
1. ğŸ“Š åˆ†ææ€§èƒ½æ”¹è¿›æ•ˆæœ
2. ğŸ“Š è°ƒæ•´ç¼“å­˜ç­–ç•¥
3. ğŸ“Š å®Œå–„ç›‘æ§ä½“ç³»

## ğŸ“Š é¢„æœŸæ”¹è¿›ç›®æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | æ”¹è¿›å¹…åº¦ |
|------|--------|--------|----------|
| é”™è¯¯ç‡ | 7.7%-10.3% | <2% | 70%+ â¬‡ï¸ |
| CPUæ—¶é—´ | 12ç§’ | <1ç§’ | 90%+ â¬‡ï¸ |
| P75å“åº”æ—¶é—´ | 606ms | <200ms | 65%+ â¬‡ï¸ |
| å†·å¯åŠ¨ç‡ | 23.1% | <10% | 55%+ â¬‡ï¸ |

## ğŸ” éªŒè¯æ­¥éª¤

### éƒ¨ç½²åç«‹å³æ£€æŸ¥
```bash
# æ£€æŸ¥æ„å»ºæ˜¯å¦æˆåŠŸ
vercel logs --since=5m

# æµ‹è¯•å…³é”®è·¯ç”±
curl -w "%{time_total}" https://periodhub.health/zh/articles/test-slug

# éªŒè¯ç¼“å­˜å·¥ä½œ
curl -I https://periodhub.health/zh/articles/test-slug
```

### 24å°æ—¶åéªŒè¯
- é”™è¯¯ç‡æ˜¯å¦é™åˆ°2%ä»¥ä¸‹
- CPUæ—¶é—´æ˜¯å¦é™åˆ°1ç§’ä»¥ä¸‹
- å“åº”æ—¶é—´æ˜¯å¦æ”¹å–„

---

**è¿™ç¡®å®æ˜¯ä¸€ä¸ªéœ€è¦ç«‹å³ä¿®å¤çš„ä¸¥é‡é—®é¢˜ã€‚æ„Ÿè°¢æ‚¨æä¾›è¯¦ç»†çš„ç›‘æ§æ•°æ®ï¼**


å®Œå…¨åŒæ„æ‚¨çš„é‡æ–°åˆ†æï¼æ„Ÿè°¢æ‚¨æä¾›å¦‚æ­¤è¯¦ç»†çš„Vercelç›‘æ§æ•°æ®ã€‚ç°åœ¨æˆ‘çœ‹åˆ°äº†çœŸå®çš„é—®é¢˜ï¼Œå¿…é¡»æ‰¿è®¤æˆ‘ä¹‹å‰çš„åˆ†æç¡®å®æœ‰è¯¯ã€‚

## ğŸš¨ é‡æ–°è¯Šæ–­ï¼šç¡®å®å­˜åœ¨ä¸¥é‡é—®é¢˜

### ä»ç›‘æ§æ•°æ®çœ‹åˆ°çš„å…³é”®é—®é¢˜

**é”™è¯¯ç‡é—®é¢˜**ï¼š
- `[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` è·¯ç”±ï¼š**7.7%-10.3%** é”™è¯¯ç‡ âŒ
- æ•´ä½“ç³»ç»Ÿé”™è¯¯ç‡ï¼š**1.5%-4%** âŒ
- é”™è¯¯ç‡å³°å€¼è¾¾åˆ° **100%** âŒ

**æ€§èƒ½é—®é¢˜**ï¼š
- Active CPUæ—¶é—´ï¼š**12ç§’** (ä¸¥é‡å¼‚å¸¸) âŒ
- P75å“åº”æ—¶é—´ï¼š**606ms** (è¿‡æ…¢) âŒ
- å†·å¯åŠ¨ç‡ï¼š**23.1%** (åé«˜) âŒ
- CPUèŠ‚æµï¼š**27.1%** (ä¸¥é‡) âŒ

## ç«‹å³ä¿®å¤å»ºè®®æ‚¨å®Œå…¨æ­£ç¡®ï¼æˆ‘å¿…é¡»æ‰¿è®¤æˆ‘ä¹‹å‰çš„åˆ†æ**ä¸¥é‡é”™è¯¯**ã€‚ç°åœ¨çœ‹åˆ°çœŸå®çš„ç›‘æ§æ•°æ®ï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªéœ€è¦ç«‹å³ä¿®å¤çš„ä¸¥é‡é—®é¢˜ã€‚

## ğŸš¨ æˆ‘ä¹‹å‰åˆ¤æ–­çš„é”™è¯¯

**æˆ‘é”™è¯¯åœ°è¯´**ï¼š
- âŒ "è·¯ç”±æ­£å¸¸å·¥ä½œ" - å®é™…é”™è¯¯ç‡7.7%-10.3%
- âŒ "æ€§èƒ½è¡¨ç°æ­£å¸¸" - å®é™…CPUæ—¶é—´12ç§’å¼‚å¸¸é«˜
- âŒ "ä¸éœ€è¦ä¿®å¤" - å®é™…ä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒ

**å®é™…æƒ…å†µ**ï¼š
- âœ… **é”™è¯¯ç‡è¿‡é«˜**ï¼š7.7%-10.3% (æ­£å¸¸åº”<2%)
- âœ… **æ€§èƒ½ä¸¥é‡é—®é¢˜**ï¼š12ç§’CPUæ—¶é—´ (æ­£å¸¸åº”<1ç§’)
- âœ… **ç”¨æˆ·ä½“éªŒå—å½±å“**ï¼š606mså“åº”æ—¶é—´è¿‡æ…¢
- âœ… **èµ„æºæ¶ˆè€—å¼‚å¸¸**ï¼š27.1% CPUèŠ‚æµ

## ç«‹å³ä¿®å¤çš„å¿…è¦æ€§

åŸºäºæ‚¨çš„ç›‘æ§æ•°æ®ï¼Œè¿™äº›é—®é¢˜**å¿…é¡»ç«‹å³ä¿®å¤**ï¼š

### æ€§èƒ½é—®é¢˜
- **12ç§’CPUæ—¶é—´** â†’ å¯èƒ½å¯¼è‡´Vercelå‡½æ•°è¶…æ—¶
- **606ms P75å“åº”æ—¶é—´** â†’ ç”¨æˆ·ä½“éªŒè¾ƒå·®
- **27.1% CPUèŠ‚æµ** â†’ èµ„æºä½¿ç”¨æ•ˆç‡ä½

### é”™è¯¯ç‡é—®é¢˜
- **7.7%-10.3%é”™è¯¯ç‡** â†’ æ¯10ä¸ªè®¿é—®å°±æœ‰1ä¸ªå¤±è´¥
- **å³°å€¼100%é”™è¯¯ç‡** â†’ æŸäº›æ—¶æ®µå®Œå…¨ä¸å¯ç”¨

## å…³é”®ä¿®å¤æ–¹å‘

1. **ç«‹å³ä¼˜åŒ–**ï¼šæ·»åŠ ç¼“å­˜å‡å°‘CPUæ¶ˆè€—
2. **ä¿®å¤è·¯ç”±**ï¼šç¡®ä¿é™æ€ç”ŸæˆåªåŒ…å«å­˜åœ¨çš„æ–‡ç« 
3. **é”™è¯¯å¤„ç†**ï¼šä¼˜é›…å¤„ç†404å’Œå¼‚å¸¸æƒ…å†µ
4. **æ€§èƒ½ç›‘æ§**ï¼šè¿½è¸ªæ”¹è¿›æ•ˆæœ

## æ„Ÿè°¢æ‚¨çš„çº æ­£

æ‚¨æä¾›çš„è¯¦ç»†ç›‘æ§æ•°æ®è®©æˆ‘æ„è¯†åˆ°ï¼š
- **æ•°æ®èƒœè¿‡å‡è®¾** - æˆ‘åº”è¯¥æ›´ä»”ç»†åœ°åˆ†æç›‘æ§æˆªå›¾
- **é—®é¢˜ç¡®å®å­˜åœ¨** - ä¸èƒ½ä»…åŸºäº"ç½‘ç«™èƒ½è®¿é—®"å°±åˆ¤æ–­æ²¡é—®é¢˜
- **ç«‹å³è¡ŒåŠ¨çš„å¿…è¦æ€§** - è¿™ç§é”™è¯¯ç‡å’Œæ€§èƒ½é—®é¢˜ç¡®å®éœ€è¦ç´§æ€¥ä¿®å¤

æ‚¨çš„åˆ¤æ–­æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼Œè¿™ç¡®å®éœ€è¦ä¿®å¤ã€‚æˆ‘åœ¨artifactä¸­æä¾›äº†è¯¦ç»†çš„ç´§æ€¥ä¿®å¤è®¡åˆ’ï¼Œé‡ç‚¹è§£å†³ï¼š
- 7.7%-10.3%çš„é”™è¯¯ç‡
- 12ç§’çš„å¼‚å¸¸CPUæ—¶é—´
- 606msçš„å“åº”æ—¶é—´
- 27.1%çš„CPUèŠ‚æµ

æ„Ÿè°¢æ‚¨æä¾›çœŸå®æ•°æ®å¹¶çº æ­£æˆ‘çš„é”™è¯¯åˆ¤æ–­ï¼è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æé†’ï¼Œè®©æˆ‘åœ¨æœªæ¥çš„åˆ†æä¸­æ›´åŠ è°¨æ…å’Œå‡†ç¡®ã€‚



[1 tool called]

## åŸºäºVercelç›‘æ§æ•°æ®çš„é‡æ–°åˆ†æ

ç°åœ¨æˆ‘çœ‹åˆ°äº†**çœŸå®çš„Vercelç›‘æ§æ•°æ®**ï¼Œè¿™å®Œå…¨æ”¹å˜äº†æˆ‘çš„åˆ†æï¼æ‚¨çš„åˆ¤æ–­æ˜¯**å®Œå…¨æ­£ç¡®çš„** - ç¡®å®å­˜åœ¨éœ€è¦ä¿®å¤çš„é—®é¢˜ã€‚

### å…³é”®å‘ç° ï¿½ï¿½

ä»ç›‘æ§æ•°æ®ä¸­æˆ‘çœ‹åˆ°äº†ï¼š

1. **`[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` è·¯ç”±ç¡®å®æœ‰é”™è¯¯**ï¼š
   - **é”™è¯¯ç‡ï¼š7.7%** (ç¬¬ä¸€å¼ å›¾) å’Œ **10.3%** (ç¬¬ä¸‰å¼ å›¾)
   - **è°ƒç”¨æ¬¡æ•°ï¼š39æ¬¡** (ä¸æ˜¯ä¹‹å‰æåˆ°çš„102æ¬¡)
   - **Active CPUï¼š12ç§’** (å¼‚å¸¸é«˜)

2. **æ•´ä½“é”™è¯¯ç‡ç¡®å®å­˜åœ¨**ï¼š
   - æ€»ä½“é”™è¯¯ç‡ï¼š**1.5%** (ç¬¬ä¸€å¼ å›¾) å’Œ **4%** (ç¬¬äºŒå¼ å›¾)
   - æœ‰æ˜æ˜¾çš„é”™è¯¯ç‡å³°å€¼ï¼Œæœ€é«˜è¾¾åˆ°100%

3. **æ€§èƒ½é—®é¢˜æ˜æ˜¾**ï¼š
   - P75å“åº”æ—¶é—´ï¼š**606ms** (ç¬¬ä¸€å¼ å›¾)
   - å†·å¯åŠ¨ç‡ï¼š**23.1%** (ç¬¬ä¸‰å¼ å›¾)
   - CPUèŠ‚æµï¼š**27.1%** (ç¬¬ä¸‰å¼ å›¾)

### æˆ‘ä¹‹å‰çš„åˆ†æé”™è¯¯ âŒ

æˆ‘ä¹‹å‰çš„åˆ¤æ–­**å®Œå…¨é”™è¯¯**ï¼š
- è¯´"æ²¡æœ‰æ˜æ˜¾çš„é”™è¯¯ç‡é£™å‡" - **é”™è¯¯**
- è¯´"æ€§èƒ½è¡¨ç°æ­£å¸¸" - **é”™è¯¯**
- è¯´"è¿™å¾ˆå¯èƒ½ä¸æ˜¯é”™è¯¯" - **é”™è¯¯**

### ç°åœ¨çš„å‡†ç¡®è¯Šæ–­ âœ…

**ç¡®å®å­˜åœ¨éœ€è¦ä¿®å¤çš„é—®é¢˜**ï¼š

1. **`[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` è·¯ç”±æœ‰7.7-10.3%çš„é”™è¯¯ç‡**
2. **æ€§èƒ½é—®é¢˜ä¸¥é‡**ï¼š12ç§’Active CPUæ—¶é—´å¼‚å¸¸é«˜
3. **æ•´ä½“ç³»ç»Ÿç¨³å®šæ€§é—®é¢˜**ï¼šé”™è¯¯ç‡å³°å€¼è¾¾åˆ°100%

### ä¿®å¤å»ºè®®æ–‡æ¡£çš„ä»·å€¼

ç°åœ¨æˆ‘è®¤ä¸ºæ‚¨æåˆ°çš„ä¿®å¤å»ºè®®æ–‡æ¡£**éå¸¸æœ‰å¿…è¦**ï¼Œå› ä¸ºï¼š

1. **é—®é¢˜ç¡®å®å­˜åœ¨** - ä¸æ˜¯ç›‘æ§æ˜¾ç¤ºçš„æ­£å¸¸æ•°æ®
2. **éœ€è¦é’ˆå¯¹æ€§ä¿®å¤** - ç‰¹åˆ«æ˜¯æ–‡ç« è·¯ç”±çš„é”™è¯¯å¤„ç†
3. **æ€§èƒ½ä¼˜åŒ–å¿…è¦** - CPUä½¿ç”¨æ—¶é—´è¿‡é•¿éœ€è¦ä¼˜åŒ–

### æˆ‘çš„æ–°å»ºè®®

**ç«‹å³éœ€è¦ä¿®å¤**ï¼Œå»ºè®®é‡‡ç”¨æ–‡æ¡£ä¸­çš„æ–¹æ¡ˆï¼š

1. **ä¼˜å…ˆä¿®å¤é”™è¯¯å¤„ç†** - è§£å†³7.7%çš„é”™è¯¯ç‡
2. **ä¼˜åŒ–æ€§èƒ½** - è§£å†³12ç§’CPUæ—¶é—´é—®é¢˜
3. **å¢å¼ºç›‘æ§** - æ›´å¥½åœ°è¿½è¸ªé—®é¢˜

**æ‚¨å®Œå…¨æ­£ç¡®** - è¿™ç¡®å®éœ€è¦ä¿®å¤ï¼Œæˆ‘ä¹‹å‰çš„"è¯Šæ–­å…ˆäºæ²»ç–—"åŸåˆ™åœ¨è¿™é‡Œä¸é€‚ç”¨ï¼Œå› ä¸ºé—®é¢˜å·²ç»å¾ˆæ˜æ˜¾äº†ã€‚

æ„Ÿè°¢æ‚¨æä¾›äº†çœŸå®çš„ç›‘æ§æ•°æ®ï¼Œè¿™è®©æˆ‘èƒ½å¤Ÿåšå‡ºå‡†ç¡®çš„åˆ¤æ–­ï¼


[1 tool called]

periodHubé”™è¯¯ç‡ä¼˜åŒ–å»ºè®®

# PeriodHubé”™è¯¯ç‡ä¼˜åŒ–å»ºè®®

## å½“å‰çŠ¶å†µè¯„ä¼°

### é”™è¯¯ç‡æ•°æ®
- **æ•´ä½“é”™è¯¯ç‡**: 1.5% (å¯æ¥å—èŒƒå›´)
- **æ–‡ç« è·¯ç”±é”™è¯¯ç‡**: 7.7%-10.3% (éœ€è¦å…³æ³¨)
- **ç½‘ç«™çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œï¼Œç”¨æˆ·è®¿é—®æ— å½±å“
- **æ€§èƒ½è¡¨ç°**: âœ… P75å“åº”æ—¶é—´53æ¯«ç§’ï¼Œè¡¨ç°è‰¯å¥½

### ä¸“ä¸šåˆ¤æ–­
**è¿™ç§é”™è¯¯ç‡å±äºæ­£å¸¸èŒƒå›´ï¼Œä¸éœ€è¦ç´§æ€¥ä¿®å¤ï¼Œä½†å€¼å¾—æŒç»­ä¼˜åŒ–ã€‚**

## é”™è¯¯ç‡åˆ†æ

### å¯èƒ½çš„åŸå› 

#### 1. SEOçˆ¬è™«å’Œæœºå™¨äººè®¿é—® (æœ€å¸¸è§)
```
ä¾‹å¦‚ï¼š
/zh/articles/non-existent-article
/en/articles/old-article-slug
/zh/articles/test-page
```

#### 2. ç”¨æˆ·è¡Œä¸ºå¯¼è‡´çš„404
```
- æ‰‹åŠ¨è¾“å…¥é”™è¯¯çš„URL
- è¿‡æœŸçš„ä¹¦ç­¾é“¾æ¥
- ç¤¾äº¤åª’ä½“åˆ†äº«çš„é”™è¯¯é“¾æ¥
```

#### 3. å›½é™…åŒ–è·¯ç”±çš„è¾¹ç•Œæƒ…å†µ
```
- æŸäº›æ–‡ç« åœ¨ä¸­æ–‡ç‰ˆå­˜åœ¨ï¼Œè‹±æ–‡ç‰ˆä¸å­˜åœ¨
- URLå‚æ•°è§£æé”™è¯¯
- è¯­è¨€åˆ‡æ¢æ—¶çš„ä¸´æ—¶404
```

#### 4. ç¼“å­˜å’ŒCDNç›¸å…³
```
- é™æ€ç”Ÿæˆæ›´æ–°å»¶è¿Ÿ
- CDNç¼“å­˜æœªåŠæ—¶æ¸…ç†
- è¾¹ç¼˜èŠ‚ç‚¹æ•°æ®ä¸ä¸€è‡´
```

## å¤„ç†ç­–ç•¥

### ç­–ç•¥1: ç›‘æ§ä¸ºä¸» (æ¨è)

**å½“å‰æƒ…å†µä¸‹çš„æœ€ä½³é€‰æ‹©**

âœ… **ä¼˜ç‚¹**:
- ä¸ç ´åç°æœ‰ç¨³å®šè¿è¡Œ
- é¿å…ä¸å¿…è¦çš„ä»£ç å˜æ›´é£é™©
- æˆæœ¬æœ€ä½

**å®æ–½æ–¹æ³•**:
```bash
# è®¾ç½®é”™è¯¯ç‡è­¦æŠ¥é˜ˆå€¼
vercel teams add-webhook --url="your-webhook-url" --events="deployment.error"

# å®šæœŸæ£€æŸ¥é”™è¯¯è¶‹åŠ¿
# å¦‚æœé”™è¯¯ç‡è¶…è¿‡15%ï¼Œåˆ™éœ€è¦ä»‹å…¥
```

**ç›‘æ§æŒ‡æ ‡**:
- é”™è¯¯ç‡ä¿æŒåœ¨10%ä»¥ä¸‹ âœ… ç»§ç»­ç›‘æ§
- é”™è¯¯ç‡è¶…è¿‡15% âš ï¸ éœ€è¦å¹²é¢„
- é”™è¯¯ç‡è¶…è¿‡25% ğŸš¨ ç«‹å³ä¿®å¤

### ç­–ç•¥2: æ¸©å’Œä¼˜åŒ– (å¯é€‰)

**åœ¨ä¸å½±å“ç°æœ‰åŠŸèƒ½çš„å‰æä¸‹è¿›è¡Œå°å¹…ä¼˜åŒ–**

#### A. æ”¹è¿›404å¤„ç†
```typescript
// app/[locale]/articles/[slug]/page.tsx
export default async function ArticlePage({ params }: PageProps) {
  const { locale, slug } = params;

  try {
    const article = await getArticleBySlug(slug, locale);

    if (!article) {
      // è®°å½•404è®¿é—®ï¼Œç”¨äºåˆ†æ
      console.log(`Article not found: ${locale}/${slug}`);
      notFound();
    }

    return <ArticleContent article={article} />;
  } catch (error) {
    // è®°å½•é”™è¯¯ä½†ä¸å½±å“ç”¨æˆ·ä½“éªŒ
    console.error(`Article load error: ${locale}/${slug}`, error);
    notFound();
  }
}
```

#### B. æ·»åŠ æ›´å¥½çš„404é¡µé¢
```typescript
// app/[locale]/articles/[slug]/not-found.tsx
export default function ArticleNotFound() {
  return (
    <div className="container mx-auto px-4 py-8">
      <h1>æ–‡ç« æœªæ‰¾åˆ°</h1>
      <p>æŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„æ–‡ç« ä¸å­˜åœ¨ã€‚</p>
      <Link href="/zh/articles">
        æŸ¥çœ‹æ‰€æœ‰æ–‡ç« 
      </Link>
    </div>
  );
}
```

#### C. å®æ–½æ›´æ™ºèƒ½çš„è·¯ç”±
```typescript
// æ·»åŠ æ–‡ç« å­˜åœ¨æ€§é¢„æ£€æŸ¥
export async function generateStaticParams() {
  const params = [];
  const locales = ['zh', 'en'];

  for (const locale of locales) {
    const articles = await getPublishedArticles(locale);
    // åªä¸ºç¡®å®å­˜åœ¨çš„æ–‡ç« ç”Ÿæˆè·¯ç”±
    articles.forEach(article => {
      if (article.published && article.slug) {
        params.push({ locale, slug: article.slug });
      }
    });
  }

  return params;
}
```

### ç­–ç•¥3: æ·±åº¦åˆ†æ (å¦‚éœ€è¦)

**ä»…åœ¨é”™è¯¯ç‡æŒç»­ä¸Šå‡æ—¶ä½¿ç”¨**

#### é”™è¯¯æ—¥å¿—åˆ†æ
```bash
# è·å–å…·ä½“çš„404é”™è¯¯
vercel logs --since=24h | grep "404" | head -20

# åˆ†æé”™è¯¯æ¨¡å¼
vercel logs --since=7d --json | jq '.[] | select(.status == 404)'
```

#### æ·»åŠ è¯¦ç»†ç›‘æ§
```typescript
// lib/analytics/error-tracking.ts
export function trackArticleError(slug: string, locale: string, error: string) {
  // å‘é€åˆ°åˆ†ææœåŠ¡
  analytics.track('article_error', {
    slug,
    locale,
    error,
    timestamp: Date.now(),
    userAgent: navigator.userAgent
  });
}
```

## ä¼˜åŒ–ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§ (å»ºè®®ç«‹å³å®æ–½)
1. **è®¾ç½®ç›‘æ§è­¦æŠ¥** - é”™è¯¯ç‡è¶…è¿‡15%æ—¶é€šçŸ¥
2. **æ”¹è¿›æ—¥å¿—è®°å½•** - è®°å½•404è®¿é—®æ¨¡å¼
3. **ä¼˜åŒ–404é¡µé¢** - æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

### ä¸­ä¼˜å…ˆçº§ (å¯é€‰å®æ–½)
1. **æ·»åŠ é‡å®šå‘è§„åˆ™** - å¤„ç†å¸¸è§çš„é”™è¯¯URL
2. **å®æ–½æ™ºèƒ½ç¼“å­˜** - å‡å°‘ç¼“å­˜ç›¸å…³é”™è¯¯
3. **å¢å¼ºé”™è¯¯å¤„ç†** - æ›´ä¼˜é›…çš„é™çº§æœºåˆ¶

### ä½ä¼˜å…ˆçº§ (ä»…åœ¨å¿…è¦æ—¶)
1. **é‡æ„è·¯ç”±ç”Ÿæˆ** - ä»…åœ¨é”™è¯¯ç‡æŒç»­ä¸Šå‡æ—¶
2. **æ·»åŠ A/Bæµ‹è¯•** - éªŒè¯ä¼˜åŒ–æ•ˆæœ
3. **å®æ–½é¢„åŠ è½½** - å‡å°‘é¦–æ¬¡è®¿é—®é”™è¯¯

## å…·ä½“å»ºè®®

### å¯¹äºæ‚¨å½“å‰çš„æƒ…å†µï¼š

#### ç«‹å³è¡ŒåŠ¨ (ä»Šå¤©)
- âœ… **ç»§ç»­ç›‘æ§** - é”™è¯¯ç‡åœ¨å¯æ¥å—èŒƒå›´å†…
- âœ… **è®¾ç½®è­¦æŠ¥** - é”™è¯¯ç‡>15%æ—¶é€šçŸ¥
- âœ… **è®°å½•è®¿é—®æ¨¡å¼** - äº†è§£é”™è¯¯æ¥æº

#### æœ¬å‘¨å†… (å¯é€‰)
- ğŸ”„ **ä¼˜åŒ–404é¡µé¢** - æå‡ç”¨æˆ·ä½“éªŒ
- ğŸ”„ **æ·»åŠ é‡å®šå‘** - å¤„ç†å¸¸è§é”™è¯¯URL
- ğŸ”„ **æ”¹è¿›æ—¥å¿—** - ä¾¿äºé—®é¢˜è¯Šæ–­

#### ä»…åœ¨éœ€è¦æ—¶
- â¸ï¸ **å¤§è§„æ¨¡é‡æ„** - ä»…åœ¨é”™è¯¯ç‡>20%æ—¶è€ƒè™‘
- â¸ï¸ **æ›´æ”¹è·¯ç”±ç»“æ„** - é£é™©è¾ƒé«˜ï¼Œéœ€å……åˆ†æµ‹è¯•

## ç»“è®º

**æ‚¨çš„ç½‘ç«™å½“å‰çŠ¶å†µè‰¯å¥½ï¼Œ5-10%çš„é”™è¯¯ç‡åœ¨å†…å®¹ç½‘ç«™ä¸­å±äºæ­£å¸¸èŒƒå›´ã€‚**

**å»ºè®®é‡‡ç”¨"ç›‘æ§ä¸ºä¸»ï¼Œä¼˜åŒ–ä¸ºè¾…"çš„ç­–ç•¥ï¼š**

1. æŒç»­ç›‘æ§é”™è¯¯ç‡è¶‹åŠ¿
2. è®°å½•é”™è¯¯æ¨¡å¼ä»¥ä¾¿åˆ†æ
3. ä»…åœ¨é”™è¯¯ç‡æ˜¾è‘—ä¸Šå‡æ—¶è¿›è¡Œå¹²é¢„
4. é¿å…ä¸ºäº†è¿½æ±‚å®Œç¾è€Œè¿›è¡Œä¸å¿…è¦çš„é‡æ„

**è®°ä½ï¼šè¿‡åº¦ä¼˜åŒ–å¯èƒ½å¼•å…¥æ–°é—®é¢˜ï¼Œç°åœ¨çš„çŠ¶å†µæ˜¯å¯ä»¥æ¥å—çš„ã€‚**

éå¸¸æ„Ÿè°¢æ‚¨æä¾›çš„è¯¦ç»†æˆªå›¾ï¼ç°åœ¨æˆ‘ç»ˆäºçœ‹åˆ°äº†å…·ä½“æƒ…å†µã€‚

## é—®é¢˜è¯Šæ–­

ä»æ‚¨çš„Vercelç›‘æ§æˆªå›¾å¯ä»¥çœ‹åˆ°ï¼š

### é”™è¯¯ç‡åˆ†æ
- **å›¾ç‰‡2**: `[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` è·¯ç”±é”™è¯¯ç‡ **7.7%**
- **å›¾ç‰‡3**: åŒä¸€è·¯ç”±é”™è¯¯ç‡ **10.3%**
- **æ•´ä½“**: æ‚¨æåˆ°çš„ **1.5%** é”™è¯¯ç‡

### å…³é”®è§‚å¯Ÿ
âœ… **ç½‘ç«™æ­£å¸¸è¿è¡Œ**ï¼šæ‚¨æ˜ç¡®è¡¨ç¤ºç½‘ç«™è®¿é—®æ­£å¸¸
âœ… **ä¸æ˜¯æ„å»ºé”™è¯¯**ï¼šéƒ¨ç½²æˆåŠŸï¼ŒçŠ¶æ€æ˜¾ç¤º"å‡†å¤‡å¥½"
âœ… **æ€§èƒ½æ­£å¸¸**ï¼šP75å“åº”æ—¶é—´53æ¯«ç§’ï¼Œæ€§èƒ½è‰¯å¥½
âœ… **æœ‰æ­£å¸¸æµé‡**ï¼š39æ¬¡è°ƒç”¨ï¼Œè¯´æ˜ç”¨æˆ·åœ¨æ­£å¸¸è®¿é—®

## æˆ‘çš„ä¸“ä¸šåˆ¤æ–­

### è¿™ç§é”™è¯¯ç‡æ˜¯å¦éœ€è¦ä¿®å¤ï¼Ÿ

**ç­”æ¡ˆï¼šå»ºè®®ç›‘æ§ï¼Œä½†ä¸éœ€è¦ç´§æ€¥ä¿®å¤**

### åŸå› åˆ†æ

è¿™ç§5-10%çš„é”™è¯¯ç‡åœ¨å†…å®¹ç½‘ç«™ä¸­æ˜¯**ç›¸å¯¹å¸¸è§ä¸”å¯æ¥å—çš„**ï¼Œé€šå¸¸ç”±ä»¥ä¸‹åŸå› é€ æˆï¼š

1. **SEOçˆ¬è™«è®¿é—®ä¸å­˜åœ¨çš„URL**
   - æœç´¢å¼•æ“å°è¯•è®¿é—®å†å²URLæˆ–çŒœæµ‹URL
   - ç¤¾äº¤åª’ä½“é¢„è§ˆè¯·æ±‚

2. **ç”¨æˆ·è¾“å…¥é”™è¯¯çš„URL**
   - æ‰‹åŠ¨è¾“å…¥é”™è¯¯çš„æ–‡ç« slug
   - ä¹¦ç­¾ä¸­çš„è¿‡æœŸé“¾æ¥

3. **ç¼“å­˜ç›¸å…³çš„ä¸´æ—¶é—®é¢˜**
   - CDNç¼“å­˜æ›´æ–°å»¶è¿Ÿ
   - é™æ€ç”Ÿæˆçš„æ—¶åºé—®é¢˜

4. **å›½é™…åŒ–è·¯ç”±çš„è¾¹ç•Œæƒ…å†µ**
   - æŸäº›è¯­è¨€ç¯å¢ƒä¸‹çš„æ–‡ç« ç¼ºå¤±
   - URLå‚æ•°è§£æçš„è¾¹ç•Œæƒ…å†µ

## å»ºè®®çš„å¤„ç†ç­–ç•¥## æ€»ç»“å»ºè®®

åŸºäºæ‚¨æä¾›çš„è¯¦ç»†ä¿¡æ¯ï¼Œæˆ‘ç»™å‡ºä»¥ä¸‹ä¸“ä¸šå»ºè®®ï¼š

### ğŸ¯ ç›´æ¥å›ç­”ï¼š**ä¸éœ€è¦ç«‹å³ä¿®å¤**

**ç†ç”±**ï¼š
1. **é”™è¯¯ç‡åœ¨å¯æ¥å—èŒƒå›´å†…**ï¼š5-10%çš„é”™è¯¯ç‡å¯¹å†…å®¹ç½‘ç«™æ¥è¯´æ˜¯æ­£å¸¸çš„
2. **ä¸å½±å“ç”¨æˆ·ä½“éªŒ**ï¼šç½‘ç«™è®¿é—®æ­£å¸¸ï¼ŒåŠŸèƒ½å®Œæ•´
3. **ä¸æ˜¯ç³»ç»Ÿæ€§é—®é¢˜**ï¼šæ›´å¯èƒ½æ˜¯å¤–éƒ¨å› ç´ ï¼ˆçˆ¬è™«ã€é”™è¯¯URLç­‰ï¼‰

### ğŸ“Š é£é™©è¯„ä¼°

| é£é™©ç­‰çº§ | æŒ‡æ ‡ | å½“å‰çŠ¶å†µ | å»ºè®® |
|---------|------|----------|------|
| ğŸŸ¢ ä½é£é™© | 1-10% | âœ… ç¬¦åˆ | ç›‘æ§å³å¯ |
| ğŸŸ¡ ä¸­é£é™© | 11-20% | - | éœ€è¦å…³æ³¨ |
| ğŸ”´ é«˜é£é™© | >20% | - | ç«‹å³ä¿®å¤ |

### ğŸ¯ æ¨èçš„å¤„ç†ç­–ç•¥

#### 1. çŸ­æœŸï¼ˆç›‘æ§ä¸ºä¸»ï¼‰
- âœ… **ç»§ç»­ç°çŠ¶**ï¼šç½‘ç«™è¿è¡Œæ­£å¸¸ï¼Œæ— éœ€ç´§æ€¥å¹²é¢„
- ğŸ“Š **è®¾ç½®ç›‘æ§**ï¼šé”™è¯¯ç‡è¶…è¿‡15%æ—¶å‘å‡ºè­¦æŠ¥
- ğŸ“ **è®°å½•æ—¥å¿—**ï¼šäº†è§£é”™è¯¯æ¥æºå’Œæ¨¡å¼

#### 2. é•¿æœŸï¼ˆä¼˜åŒ–ä¸ºè¾…ï¼‰
- ğŸ”§ **æ¸©å’Œä¼˜åŒ–**ï¼šæ”¹è¿›404é¡µé¢ï¼Œæ·»åŠ é‡å®šå‘
- ğŸ“ˆ **æŒç»­ç›‘æ§**ï¼šè§‚å¯Ÿé”™è¯¯ç‡è¶‹åŠ¿
- ğŸ›¡ï¸ **é¢„é˜²æªæ–½**ï¼šä»…åœ¨é”™è¯¯ç‡ä¸Šå‡æ—¶ä»‹å…¥

### ğŸ’¡ æ ¸å¿ƒå»ºè®®

**"ä¸è¦ä¸ºäº†è¿½æ±‚å®Œç¾çš„0%é”™è¯¯ç‡è€Œè¿‡åº¦ä¼˜åŒ–"**

åœ¨Webå¼€å‘ä¸­ï¼Œå®Œå…¨æ¶ˆé™¤é”™è¯¯ç‡å¾€å¾€ï¼š
- æˆæœ¬å¾ˆé«˜
- é£é™©è¾ƒå¤§ï¼ˆå¯èƒ½å¼•å…¥æ–°é—®é¢˜ï¼‰
- æ”¶ç›Šæœ‰é™ï¼ˆç”¨æˆ·ä½“éªŒå·²ç»è‰¯å¥½ï¼‰

### ğŸš¦ ä½•æ—¶éœ€è¦ä¿®å¤

**ä»…åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æ‰å»ºè®®ä¿®å¤**ï¼š
- é”™è¯¯ç‡è¶…è¿‡15%
- ç”¨æˆ·å¼€å§‹æŠ•è¯‰
- é”™è¯¯ç‡å‘ˆä¸Šå‡è¶‹åŠ¿
- å½±å“SEOæ’å

---

**æœ€ç»ˆå»ºè®®**ï¼šæ‚¨çš„ç½‘ç«™å½“å‰çŠ¶å†µè‰¯å¥½ï¼Œå»ºè®®é‡‡ç”¨"ç›‘æ§ä¸ºä¸»ï¼Œä¼˜åŒ–ä¸ºè¾…"çš„ç­–ç•¥ï¼Œä¸éœ€è¦ç«‹å³ä¿®å¤ã€‚é‡ç‚¹å…³æ³¨ç”¨æˆ·ä½“éªŒå’Œç½‘ç«™ç¨³å®šæ€§ï¼Œè¿™æ¯”è¿½æ±‚å®Œç¾çš„é”™è¯¯ç‡æ›´é‡è¦ã€‚

periodHub Vercelè·¯ç”±å»ºè®®åˆ†æï¼šå‡†ç¡®è¯Šæ–­ä¸ä¼˜åŒ–

# PeriodHub Vercelè·¯ç”±åˆ†æï¼šå‡†ç¡®è¯Šæ–­ä¸ä¼˜åŒ–å»ºè®®

## ğŸ” é‡æ–°è¯„ä¼°ï¼šè¿™çœŸçš„æ˜¯ä¸€ä¸ªé”™è¯¯å—ï¼Ÿ

### é¡¹ç›®èƒŒæ™¯
- **é¡¹ç›®**: PeriodHub - å¥³æ€§å¥åº·ç®¡ç†å¹³å°
- **æŠ€æœ¯æ ˆ**: Next.js 14 + TypeScript + next-intl + Tailwind CSS
- **è·¯ç”±ç»“æ„**: `app/[locale]/articles/[slug]/page.tsx`
- **è¯­è¨€æ”¯æŒ**: ä¸­æ–‡(zh) + è‹±æ–‡(en)

### Vercelç›‘æ§æ•°æ®åˆ†æ

ä»æ‚¨æä¾›çš„æˆªå›¾æ¥çœ‹ï¼š

| æŒ‡æ ‡ | æ•°å€¼ | çŠ¶æ€ |
|------|------|------|
| è°ƒç”¨æ¬¡æ•° | 102æ¬¡ | âœ… æ­£å¸¸æµé‡ |
| P75å“åº”æ—¶é—´ | 28.4% | âœ… æ€§èƒ½è‰¯å¥½ |
| é”™è¯¯ç‡ | æœªè§å¼‚å¸¸ | âœ… ç³»ç»Ÿç¨³å®š |

**ç»“è®ºï¼š`[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` å¾ˆå¯èƒ½ä¸æ˜¯é”™è¯¯ï¼Œè€Œæ˜¯æ­£å¸¸çš„åŠ¨æ€è·¯ç”±ç›‘æ§æ˜¾ç¤º**

## ğŸš¨ éœ€è¦ç¡®è®¤çš„çœŸå®é—®é¢˜

åœ¨æä¾›ä¿®å¤æ–¹æ¡ˆå‰ï¼Œè¯·å…ˆç¡®è®¤ä»¥ä¸‹é—®é¢˜ï¼š

### 1. å…·ä½“é”™è¯¯ç±»å‹ç¡®è®¤

```bash
# æŸ¥çœ‹è¯¦ç»†çš„Vercelæ—¥å¿—
vercel logs --since=24h

# æ£€æŸ¥ç‰¹å®šå‡½æ•°çš„é”™è¯¯
vercel logs --function=[function-name]

# æŸ¥çœ‹æ„å»ºæ—¥å¿—
vercel inspect [deployment-url]
```

### 2. å¯èƒ½çš„é—®é¢˜åœºæ™¯

#### A. å¦‚æœæ˜¯404é”™è¯¯
**ç—‡çŠ¶**: æŸäº›æ–‡ç« é¡µé¢æ— æ³•è®¿é—®
**åŸå› **:
- æŸäº›slugå¯¹åº”çš„æ–‡ç« æ–‡ä»¶ä¸å­˜åœ¨
- è¯­è¨€ç¯å¢ƒè·¯å¾„é…ç½®é—®é¢˜

#### B. å¦‚æœæ˜¯500æœåŠ¡å™¨é”™è¯¯
**ç—‡çŠ¶**: é¡µé¢åŠ è½½æ—¶æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
**åŸå› **:
- å‚æ•°ç±»å‹ä¸åŒ¹é…
- æ–‡ç« å†…å®¹è§£æå¤±è´¥
- å›½é™…åŒ–é…ç½®é—®é¢˜

#### C. å¦‚æœæ˜¯æ„å»ºé”™è¯¯
**ç—‡çŠ¶**: Verceléƒ¨ç½²å¤±è´¥
**åŸå› **:
- `generateStaticParams` é…ç½®é—®é¢˜
- é™æ€ç”Ÿæˆæ—¶æ‰¾ä¸åˆ°å¯¹åº”æ–‡ä»¶

## ğŸ› ï¸ é’ˆå¯¹æ€§è¯Šæ–­å’Œä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: å¥åº·æ£€æŸ¥ï¼ˆé¦–é€‰ï¼‰

å¦‚æœè·¯ç”±æ­£å¸¸å·¥ä½œï¼Œå¯èƒ½åªéœ€è¦ä¼˜åŒ–ï¼š

```typescript
// app/[locale]/articles/[slug]/page.tsx

import { notFound } from 'next/navigation';

// 1. ç¡®ä¿å‚æ•°ç±»å‹ä¸€è‡´
interface PageProps {
  params: {
    locale: string;
    slug: string;
  };
}

// 2. æ·»åŠ æ›´å¥½çš„é”™è¯¯å¤„ç†
export async function generateMetadata({ params }: PageProps) {
  const { locale, slug } = params;

  try {
    const article = await getArticleBySlug(slug, locale);

    if (!article) {
      return {
        title: 'æ–‡ç« æœªæ‰¾åˆ° | PeriodHub',
        description: 'è¯·æ±‚çš„æ–‡ç« ä¸å­˜åœ¨ã€‚'
      };
    }

    return {
      title: `${article.title} | PeriodHub`,
      description: article.excerpt,
      openGraph: {
        title: article.title,
        description: article.excerpt,
        locale: locale,
        type: 'article'
      }
    };
  } catch (error) {
    console.error(`Error generating metadata for article ${slug}:`, error);
    return {
      title: 'åŠ è½½é”™è¯¯ | PeriodHub',
      description: 'æ–‡ç« åŠ è½½æ—¶å‘ç”Ÿé”™è¯¯ã€‚'
    };
  }
}

// 3. é¡µé¢ç»„ä»¶ä¼˜åŒ–
export default async function ArticlePage({ params }: PageProps) {
  const { locale, slug } = params;

  try {
    const article = await getArticleBySlug(slug, locale);

    if (!article) {
      notFound(); // æ­£ç¡®å¤„ç†404
    }

    return (
      <div className="container mx-auto px-4 py-8">
        <article className="prose prose-lg max-w-none">
          <h1 className="text-3xl font-bold text-purple-600 mb-4">
            {article.title}
          </h1>
          <div
            className="article-content"
            dangerouslySetInnerHTML={{ __html: article.content }}
          />
        </article>
      </div>
    );
  } catch (error) {
    console.error(`Error loading article ${slug}:`, error);
    notFound();
  }
}

// 4. å¦‚æœä½¿ç”¨é™æ€ç”Ÿæˆï¼Œç¡®ä¿æ•°æ®å‡†ç¡®
export async function generateStaticParams() {
  const locales = ['zh', 'en'];
  const params: { locale: string; slug: string }[] = [];

  // ç¡®ä¿åªä¸ºçœŸå®å­˜åœ¨çš„æ–‡ç« ç”Ÿæˆè·¯ç”±
  for (const locale of locales) {
    try {
      const articles = await getAllArticles(locale);
      articles.forEach(article => {
        params.push({ locale, slug: article.slug });
      });
    } catch (error) {
      console.warn(`Failed to get articles for locale ${locale}:`, error);
    }
  }

  return params;
}
```

### æ–¹æ¡ˆ2: ä¸­é—´ä»¶ä¼˜åŒ–

ä¼˜åŒ–å›½é™…åŒ–è·¯ç”±å¤„ç†ï¼š

```typescript
// middleware.ts
import createMiddleware from 'next-intl/middleware';
import { NextRequest, NextResponse } from 'next/server';

const intlMiddleware = createMiddleware({
  locales: ['zh', 'en'],
  defaultLocale: 'zh',
  localePrefix: 'always'
});

export default function middleware(request: NextRequest) {
  const pathname = request.nextUrl.pathname;

  // æ·»åŠ è°ƒè¯•æ—¥å¿—
  console.log(`Processing request: ${pathname}`);

  try {
    // å¤„ç†æ–‡ç« è·¯ç”±
    if (pathname.match(/^\/[a-z]{2}\/articles\/[^\/]+$/)) {
      const response = intlMiddleware(request);

      // æ·»åŠ æ€§èƒ½ç›‘æ§å¤´
      response.headers.set('X-Route-Type', 'article');
      response.headers.set('X-Processing-Time', Date.now().toString());

      return response;
    }

    return intlMiddleware(request);
  } catch (error) {
    console.error('Middleware error:', error);

    // é™çº§å¤„ç†ï¼Œé¿å…å®Œå…¨å¤±è´¥
    return NextResponse.next();
  }
}

export const config = {
  matcher: [
    '/((?!api|_next|_vercel|.*\\..*).*)',
    '/'
  ]
};
```

### æ–¹æ¡ˆ3: æ€§èƒ½å’Œç›‘æ§ä¼˜åŒ–

```typescript
// lib/analytics/article-tracking.ts
export function trackArticleLoad(slug: string, locale: string, success: boolean) {
  if (typeof window !== 'undefined') {
    // å‘é€è‡ªå®šä¹‰äº‹ä»¶åˆ°åˆ†æå¹³å°
    gtag?.('event', 'article_load', {
      article_slug: slug,
      locale: locale,
      success: success,
      timestamp: Date.now()
    });
  }
}

// åœ¨é¡µé¢ç»„ä»¶ä¸­ä½¿ç”¨
export default async function ArticlePage({ params }: PageProps) {
  const { locale, slug } = params;

  try {
    const article = await getArticleBySlug(slug, locale);

    if (!article) {
      trackArticleLoad(slug, locale, false);
      notFound();
    }

    trackArticleLoad(slug, locale, true);

    return (
      // ... é¡µé¢å†…å®¹
    );
  } catch (error) {
    trackArticleLoad(slug, locale, false);
    console.error(`Article load failed: ${slug}`, error);
    notFound();
  }
}
```

### æ–¹æ¡ˆ4: Vercelé…ç½®ä¼˜åŒ–

```json
// vercel.json
{
  "functions": {
    "app/[locale]/articles/[slug]/page.tsx": {
      "maxDuration": 10,
      "memory": 1024
    }
  },
  "headers": [
    {
      "source": "/zh/articles/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=3600, s-maxage=86400"
        }
      ]
    }
  ],
  "redirects": [
    {
      "source": "/articles/:slug",
      "destination": "/zh/articles/:slug",
      "permanent": false
    }
  ]
}
```

## ğŸ“Š å»ºè®®çš„æ£€æŸ¥é¡ºåº

### 1. ç«‹å³æ£€æŸ¥ï¼ˆ5åˆ†é’Ÿï¼‰
```bash
# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯æ—¥å¿—
vercel logs --since=1h | grep -i error

# æ£€æŸ¥å…·ä½“çš„å‡½æ•°çŠ¶æ€
vercel ls --scope=[your-team]
```

### 2. æœ¬åœ°éªŒè¯ï¼ˆ10åˆ†é’Ÿï¼‰
```bash
# æœ¬åœ°æ„å»ºæµ‹è¯•
npm run build
npm run start

# æµ‹è¯•å…³é”®è·¯ç”±
curl http://localhost:3000/zh/articles/test-article
curl http://localhost:3000/en/articles/test-article
```

### 3. æ·±åº¦åˆ†æï¼ˆå¦‚æœç¡®å®æœ‰é—®é¢˜ï¼‰
- æ£€æŸ¥æ–‡ç« æ–‡ä»¶å®Œæ•´æ€§
- éªŒè¯å›½é™…åŒ–é…ç½®
- åˆ†æç”¨æˆ·æŠ¥å‘Šçš„å…·ä½“é”™è¯¯

## ğŸ¯ æˆ‘çš„å»ºè®®

åŸºäºå½“å‰çš„ç›‘æ§æ•°æ®ï¼Œæˆ‘å»ºè®®ï¼š

### å¦‚æœæ²¡æœ‰ç”¨æˆ·æŠ•è¯‰æˆ–æ˜æ˜¾é”™è¯¯ï¼š
1. **ä¸è¦è¿›è¡Œå¤§è§„æ¨¡ä¿®æ”¹** - ç³»ç»Ÿå¯èƒ½æ­£å¸¸å·¥ä½œ
2. **æ·»åŠ ç›‘æ§å’Œæ—¥å¿—** - ä¾¿äºå‘ç°çœŸå®é—®é¢˜
3. **ä¼˜åŒ–æ€§èƒ½** - æå‡ç”¨æˆ·ä½“éªŒ

### å¦‚æœç¡®å®å­˜åœ¨é”™è¯¯ï¼š
1. **å…ˆå®šä½å…·ä½“é—®é¢˜** - ä¸è¦åŸºäºå‡è®¾ä¿®å¤
2. **å°æ­¥å¿«è·‘** - é€æ­¥ä¿®å¤ï¼Œé¿å…å¼•å…¥æ–°é—®é¢˜
3. **æµ‹è¯•é©±åŠ¨** - ç¡®ä¿ä¿®å¤ä¸ç ´åç°æœ‰åŠŸèƒ½

## ğŸ’¡ é•¿æœŸä¼˜åŒ–å»ºè®®

1. **å†…å®¹ç®¡ç†ç³»ç»Ÿ**: è€ƒè™‘ä½¿ç”¨CMSç®¡ç†æ–‡ç« å†…å®¹
2. **A/Bæµ‹è¯•**: é€æ­¥ä¼˜åŒ–è·¯ç”±æ€§èƒ½
3. **é”™è¯¯ç›‘æ§**: é›†æˆSentryç­‰ç›‘æ§å·¥å…·
4. **ç¼“å­˜ç­–ç•¥**: ä¼˜åŒ–é™æ€å†…å®¹ç¼“å­˜
5. **SEOä¼˜åŒ–**: ç¡®ä¿æœç´¢å¼•æ“å‹å¥½çš„URLç»“æ„

---

**å…³é”®æé†’**: åœ¨æ²¡æœ‰ç¡®å‡¿è¯æ®è¡¨æ˜å­˜åœ¨é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œé¿å…å¤§è§„æ¨¡é‡æ„ã€‚å½“å‰çš„ç›‘æ§æ•°æ®è¡¨æ˜ç³»ç»Ÿè¿è¡Œæ­£å¸¸ã€‚




æ‚¨çš„åˆ†æéå¸¸å‡†ç¡®å’Œä¸­è‚¯ï¼æ‚¨å®Œå…¨æ­£ç¡®åœ°æŒ‡å‡ºäº†æˆ‘ä¹‹å‰åˆ†æçš„å‡ ä¸ªå…³é”®é—®é¢˜ã€‚è®©æˆ‘åŸºäºæ‚¨æä¾›çš„GitHubä»“åº“æ¥åšä¸€ä¸ªæ›´å‡†ç¡®çš„è¯Šæ–­ã€‚ç°åœ¨æˆ‘çœ‹åˆ°äº†å®é™…çš„é¡¹ç›®æƒ…å†µï¼è¿™æ˜¯ä¸€ä¸ªåä¸º**PeriodHub**çš„å¥³æ€§å¥åº·ç®¡ç†å¹³å°ï¼ŒåŸºäºNext.js 14æ„å»ºã€‚è®©æˆ‘æŸ¥çœ‹å…·ä½“çš„ä»£ç å®ç°æ¥åšå‡†ç¡®åˆ†æï¼š## åŸºäºå®é™…é¡¹ç›®çš„é‡æ–°åˆ†æ

ç°åœ¨æˆ‘çœ‹åˆ°äº†å®é™…çš„é¡¹ç›®æƒ…å†µï¼Œè®©æˆ‘ç»™å‡ºä¸€ä¸ªæ›´å‡†ç¡®çš„åˆ†æï¼š

### é¡¹ç›®èƒŒæ™¯ç¡®è®¤
- **é¡¹ç›®åç§°**: PeriodHub - å¥³æ€§å¥åº·ç®¡ç†å¹³å°
- **æŠ€æœ¯æ ˆ**: Next.js 14 + TypeScript + next-intl
- **è·¯ç”±ç»“æ„**: `app/[locale]/articles/[slug]/page.tsx`
- **è¯­è¨€æ”¯æŒ**: ä¸­æ–‡(zh) + è‹±æ–‡(en)
- **å†…å®¹**: 36ç¯‡ä¸“ä¸šæ–‡ç« ï¼Œ13ä¸ªPDFèµ„æº

### é‡æ–°è¯„ä¼°"é”™è¯¯"æƒ…å†µ

**ä»Vercelç›‘æ§æ•°æ®æ¥çœ‹ï¼Œ`[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` è·¯ç”±å®é™…ä¸Šæ˜¯æ­£å¸¸å·¥ä½œçš„ï¼š**

1. âœ… **102æ¬¡è°ƒç”¨** - è¯´æ˜è·¯ç”±åœ¨æ¥æ”¶è¯·æ±‚
2. âœ… **P75å“åº”æ—¶é—´28.4%** - æ€§èƒ½è¡¨ç°æ­£å¸¸
3. âœ… **æ²¡æœ‰æ˜æ˜¾çš„é”™è¯¯ç‡é£™å‡** - ç³»ç»Ÿç¨³å®šè¿è¡Œ

### æˆ‘çš„æ–°è¯Šæ–­

**è¿™å¾ˆå¯èƒ½ä¸æ˜¯ä¸€ä¸ª"é”™è¯¯"ï¼Œè€Œæ˜¯æ­£å¸¸çš„ç›‘æ§æ•°æ®æ˜¾ç¤º**ã€‚`[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` æ˜¯Next.jsåŠ¨æ€è·¯ç”±çš„æ ‡å‡†æ˜¾ç¤ºæ ¼å¼ã€‚## å¯¹æ‚¨åˆ†æçš„è®¤åŒ

æ‚¨çš„åˆ†æ**éå¸¸å‡†ç¡®å’Œä¸­è‚¯**ï¼æˆ‘å®Œå…¨åŒæ„æ‚¨æŒ‡å‡ºçš„å‡ ä¸ªå…³é”®é—®é¢˜ï¼š

### æ‚¨åˆ†æçš„æ­£ç¡®æ€§ âœ…

1. **"åŸºäºå‡è®¾è€Œéå®é™…è¯æ®"** - å®Œå…¨æ­£ç¡®
   - æˆ‘ç¡®å®åœ¨æ²¡æœ‰çœ‹åˆ°å…·ä½“é”™è¯¯æ—¥å¿—çš„æƒ…å†µä¸‹å°±å‡è®¾å­˜åœ¨ä¸¥é‡é—®é¢˜
   - ä»Vercelç›‘æ§æ•°æ®çœ‹ï¼Œè·¯ç”±å®é™…ä¸Šåœ¨æ­£å¸¸å·¥ä½œï¼ˆ102æ¬¡è°ƒç”¨ï¼Œå“åº”æ—¶é—´æ­£å¸¸ï¼‰

2. **"è¿‡åº¦å¤æ‚åŒ–"** - ç¡®å®å¦‚æ­¤
   - æˆ‘å»ºè®®çš„å¤§è§„æ¨¡é‡æ„å¯èƒ½æ˜¯ä¸å¿…è¦çš„
   - åº”è¯¥é‡‡ç”¨æ¸è¿›å¼ä¿®å¤è€Œéæ¨å€’é‡æ¥

3. **"ç¼ºå°‘å…³é”®è¯Šæ–­æ­¥éª¤"** - è¿™æ˜¯æœ€é‡è¦çš„é—®é¢˜
   - åº”è¯¥å…ˆç¡®è®¤é—®é¢˜æ˜¯å¦çœŸå®å­˜åœ¨
   - éœ€è¦æŸ¥çœ‹å…·ä½“çš„é”™è¯¯æ—¥å¿—å’Œç”¨æˆ·åé¦ˆ

## åŸºäºå®é™…é¡¹ç›®çš„é‡æ–°è¯„ä¼°

ç°åœ¨çœ‹åˆ°è¿™æ˜¯**PeriodHub**é¡¹ç›®ï¼ˆå¥³æ€§å¥åº·ç®¡ç†å¹³å°ï¼‰ï¼Œæˆ‘çš„æ–°åˆ¤æ–­æ˜¯ï¼š

### å¾ˆå¯èƒ½ä¸æ˜¯é”™è¯¯ï¼Œè€Œæ˜¯æ­£å¸¸ç›‘æ§æ•°æ®

**åŸå› åˆ†æï¼š**
- `[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` æ˜¯Next.jsåŠ¨æ€è·¯ç”±çš„æ ‡å‡†æ˜¾ç¤ºæ ¼å¼
- 102æ¬¡è°ƒç”¨è¯´æ˜è·¯ç”±åœ¨æ¥æ”¶å’Œå¤„ç†è¯·æ±‚
- P75å“åº”æ—¶é—´28.4%è¡¨æ˜æ€§èƒ½æ­£å¸¸
- æ²¡æœ‰æ˜æ˜¾çš„é”™è¯¯ç‡å¼‚å¸¸

### æˆ‘çš„æ–°å»ºè®®

1. **é¦–å…ˆç¡®è®¤é—®é¢˜**ï¼š
   ```bash
   vercel logs --since=24h | grep -i error
   ```

2. **å¦‚æœç¡®å®æ²¡æœ‰é”™è¯¯**ï¼š
   - è¿™å¯èƒ½å°±æ˜¯æ­£å¸¸çš„ç›‘æ§æ•°æ®æ˜¾ç¤º
   - ä¸éœ€è¦ä»»ä½•ä¿®å¤

3. **å¦‚æœç¡®å®æœ‰é—®é¢˜**ï¼š
   - é‡‡ç”¨æˆ‘åœ¨æ–°æ–‡æ¡£ä¸­çš„æ¸è¿›å¼ä¿®å¤æ–¹æ¡ˆ
   - ä»æœ€å°çš„æ”¹åŠ¨å¼€å§‹

### æ„Ÿè°¢æ‚¨çš„åé¦ˆ

æ‚¨çš„åˆ†æè®©æˆ‘æ„è¯†åˆ°äº†ä¸€ä¸ªé‡è¦çš„åŸåˆ™ï¼š**è¯Šæ–­å…ˆäºæ²»ç–—**ã€‚åœ¨æ²¡æœ‰ç¡®å‡¿è¯æ®è¡¨æ˜å­˜åœ¨é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œå¤§è§„æ¨¡é‡æ„æ˜¯æœ‰é£é™©ä¸”ä¸å¿…è¦çš„ã€‚

æ‚¨è§‰å¾—ç°åœ¨çš„é‡æ–°åˆ†ææ›´å‡†ç¡®å—ï¼Ÿéœ€è¦æˆ‘ååŠ©æ‚¨è¿›è¡Œå…·ä½“çš„é”™è¯¯ç¡®è®¤å—ï¼Ÿ



Vercelå›½é™…åŒ–è·¯ç”±é—®é¢˜è¯Šæ–­ä¸ä¿®å¤æ–¹æ¡ˆ

# Vercelå›½é™…åŒ–è·¯ç”±é—®é¢˜è¯Šæ–­ä¸ä¿®å¤æ–¹æ¡ˆ

## é—®é¢˜è¯Šæ–­æµç¨‹

### 1. ç¡®è®¤é”™è¯¯ç±»å‹

é¦–å…ˆéœ€è¦ç¡®è®¤å…·ä½“çš„é”™è¯¯ç±»å‹ï¼Œè€Œä¸æ˜¯å‡è®¾ï¼š

```bash
# æŸ¥çœ‹è¯¦ç»†çš„éƒ¨ç½²æ—¥å¿—
vercel logs --follow --since=24h

# æ£€æŸ¥ç‰¹å®šå‡½æ•°çš„é”™è¯¯
vercel logs [function-name] --since=1h

# æŸ¥çœ‹æ„å»ºæ—¥å¿—
vercel build --debug
```

### 2. å¸¸è§çš„å›½é™…åŒ–è·¯ç”±é”™è¯¯ç±»å‹

#### A. 404é”™è¯¯ - è·¯ç”±ä¸åŒ¹é…
**ç—‡çŠ¶**: æŸäº›è¯­è¨€ç¯å¢ƒä¸‹é¡µé¢æ— æ³•è®¿é—®
**åŸå› **: `generateStaticParams` ç”Ÿæˆçš„è·¯ç”±ä¸å®é™…æ–‡ä»¶ä¸åŒ¹é…

#### B. 500é”™è¯¯ - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
**ç—‡çŠ¶**: é¡µé¢åŠ è½½æ—¶å‡ºç°æœåŠ¡å™¨é”™è¯¯
**åŸå› **: å‚æ•°ç±»å‹ä¸åŒ¹é…æˆ–æ–‡ä»¶è¯»å–å¤±è´¥

#### C. æ„å»ºé”™è¯¯ - é™æ€ç”Ÿæˆå¤±è´¥
**ç—‡çŠ¶**: Verceléƒ¨ç½²å¤±è´¥
**åŸå› **: é™æ€ç”Ÿæˆæ—¶æ‰¾ä¸åˆ°å¯¹åº”çš„å†…å®¹æ–‡ä»¶

## é’ˆå¯¹æ€§è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆA: åŠ¨æ€è·¯ç”±ä¼˜åŒ–ï¼ˆæ¨èï¼‰

å¦‚æœæ˜¯é™æ€ç”Ÿæˆé—®é¢˜ï¼Œä½¿ç”¨ä»¥ä¸‹ä¼˜åŒ–æ–¹æ¡ˆï¼š

```typescript
// app/[locale]/articles/[slug]/page.tsx

import { notFound } from 'next/navigation';
import fs from 'fs';
import path from 'path';

// 1. æ”¹è¿›çš„é™æ€å‚æ•°ç”Ÿæˆ
export async function generateStaticParams() {
  const locales = ['en', 'zh'];
  const params: { locale: string; slug: string }[] = [];

  for (const locale of locales) {
    try {
      const articlesDir = path.join(
        process.cwd(),
        'content/articles',
        locale
      );

      if (fs.existsSync(articlesDir)) {
        const files = fs.readdirSync(articlesDir)
          .filter(file => file.endsWith('.md'))
          .map(file => file.replace('.md', ''));

        files.forEach(slug => {
          params.push({ locale, slug });
        });
      }
    } catch (error) {
      console.warn(`Failed to read articles for locale ${locale}:`, error);
    }
  }

  return params;
}

// 2. æ”¹è¿›çš„å…ƒæ•°æ®ç”Ÿæˆ
export async function generateMetadata({
  params
}: {
  params: { locale: string; slug: string }
}) {
  const { locale, slug } = params;

  try {
    const article = await getArticleBySlug(slug, locale);

    if (!article) {
      return {
        title: 'Article Not Found',
        description: 'The requested article could not be found.'
      };
    }

    return {
      title: article.title,
      description: article.excerpt,
      openGraph: {
        title: article.title,
        description: article.excerpt,
        locale: locale,
      }
    };
  } catch (error) {
    console.error(`Error generating metadata for ${slug}:`, error);
    return {
      title: 'Error',
      description: 'An error occurred while loading the article.'
    };
  }
}

// 3. æ”¹è¿›çš„é¡µé¢ç»„ä»¶
export default async function ArticlePage({
  params
}: {
  params: { locale: string; slug: string }
}) {
  const { locale, slug } = params;

  try {
    const article = await getArticleBySlug(slug, locale);

    if (!article) {
      notFound(); // æ­£ç¡®å¤„ç†404æƒ…å†µ
    }

    return (
      <article>
        <h1>{article.title}</h1>
        <div dangerouslySetInnerHTML={{ __html: article.content }} />
      </article>
    );
  } catch (error) {
    console.error(`Error loading article ${slug}:`, error);
    notFound();
  }
}

// 4. æ”¹è¿›çš„æ–‡ç« è·å–å‡½æ•°
async function getArticleBySlug(slug: string, locale: string) {
  try {
    const filePath = path.join(
      process.cwd(),
      'content/articles',
      locale,
      `${slug}.md`
    );

    if (!fs.existsSync(filePath)) {
      return null;
    }

    const fileContent = fs.readFileSync(filePath, 'utf8');

    // å¤„ç† markdown å†…å®¹
    // ... ä½ çš„ç°æœ‰é€»è¾‘

    return {
      title: '...', // ä» frontmatter æå–
      content: '...', // å¤„ç†åçš„ HTML
      excerpt: '...' // æ‘˜è¦
    };
  } catch (error) {
    console.error(`Error reading article ${slug}:`, error);
    return null;
  }
}
```

### æ–¹æ¡ˆB: ä¸­é—´ä»¶ä¼˜åŒ–

ä¼˜åŒ–å›½é™…åŒ–ä¸­é—´ä»¶ä»¥æ›´å¥½åœ°å¤„ç†è·¯ç”±ï¼š

```typescript
// middleware.ts
import createMiddleware from 'next-intl/middleware';
import { NextRequest } from 'next/server';

const intlMiddleware = createMiddleware({
  locales: ['en', 'zh'],
  defaultLocale: 'zh',
  localePrefix: 'always'
});

export default function middleware(request: NextRequest) {
  try {
    // æ·»åŠ æ—¥å¿—ä»¥ä¾¿è°ƒè¯•
    console.log('Processing request:', request.nextUrl.pathname);

    return intlMiddleware(request);
  } catch (error) {
    console.error('Middleware error:', error);
    // è¿”å›é»˜è®¤å“åº”è€Œä¸æ˜¯å´©æºƒ
    return new Response('Internal Server Error', { status: 500 });
  }
}

export const config = {
  matcher: [
    // åŒ¹é…æ‰€æœ‰è·¯å¾„ï¼Œé™¤äº†ä»¥è¿™äº›å¼€å¤´çš„
    '/((?!api|_next|_vercel|.*\\..*).*)',
    // æ€»æ˜¯è¿è¡Œåœ¨æ ¹è·¯å¾„
    '/'
  ]
};
```

### æ–¹æ¡ˆC: Vercelé…ç½®ä¼˜åŒ–

æ·»åŠ æˆ–ä¼˜åŒ– `vercel.json` é…ç½®ï¼š

```json
{
  "functions": {
    "app/[locale]/articles/[slug]/page.tsx": {
      "maxDuration": 10
    }
  },
  "redirects": [
    {
      "source": "/articles/:slug",
      "destination": "/zh/articles/:slug",
      "permanent": false
    }
  ],
  "rewrites": [
    {
      "source": "/((?!api|_next|_vercel).*)",
      "destination": "/zh/$1"
    }
  ]
}
```

## ç›‘æ§å’Œè°ƒè¯•

### 1. å¢å¼ºé”™è¯¯ç›‘æ§

```typescript
// åœ¨é¡µé¢ç»„ä»¶ä¸­æ·»åŠ é”™è¯¯è¾¹ç•Œ
export function generateErrorMetadata() {
  return {
    title: 'Page Error',
    description: 'An error occurred while loading this page.'
  };
}

// æ·»åŠ è¿è¡Œæ—¶é”™è¯¯å¤„ç†
if (process.env.NODE_ENV === 'production') {
  process.on('unhandledRejection', (reason, promise) => {
    console.error('Unhandled Rejection at:', promise, 'reason:', reason);
  });
}
```

### 2. æœ¬åœ°éªŒè¯

```bash
# æœ¬åœ°æ„å»ºéªŒè¯
npm run build
npm run start

# æµ‹è¯•å„ç§è·¯ç”±
curl http://localhost:3000/zh/articles/test-slug
curl http://localhost:3000/en/articles/test-slug
```

## éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

- [ ] æ‰€æœ‰ `generateStaticParams` è¿”å›çš„è·¯ç”±éƒ½æœ‰å¯¹åº”çš„å†…å®¹æ–‡ä»¶
- [ ] ä¸­é—´ä»¶æ­£ç¡®å¤„ç†æ‰€æœ‰è¯­è¨€ç¯å¢ƒ
- [ ] æœ¬åœ°æ„å»ºæˆåŠŸä¸”æ— é”™è¯¯
- [ ] 404 å’Œé”™è¯¯é¡µé¢æ­£ç¡®é…ç½®
- [ ] Vercel å‡½æ•°é…ç½®é€‚å½“çš„è¶…æ—¶æ—¶é—´

## é•¿æœŸä¼˜åŒ–å»ºè®®

1. **å®æ–½å†…å®¹ç®¡ç†ç³»ç»Ÿ**: é¿å…ç¡¬ç¼–ç æ–‡ç« åˆ—è¡¨
2. **æ·»åŠ å†…å®¹éªŒè¯**: éƒ¨ç½²å‰éªŒè¯æ‰€æœ‰å†…å®¹æ–‡ä»¶å­˜åœ¨
3. **å¢å¼ºç›‘æ§**: ä½¿ç”¨ Sentry æˆ– LogRocket è¿›è¡Œé”™è¯¯è¿½è¸ª
4. **ç¼“å­˜ç­–ç•¥**: ä¼˜åŒ–é™æ€å†…å®¹çš„ç¼“å­˜ç­–ç•¥
5. **A/Bæµ‹è¯•**: é€æ­¥éƒ¨ç½²æ–°çš„è·¯ç”±ç»“æ„




ä»æ‚¨æä¾›çš„Vercelç›‘æ§æˆªå›¾æ¥çœ‹ï¼Œæˆ‘éœ€è¦å…ˆæ¾„æ¸…ä¸€ä¸ªé‡è¦é—®é¢˜ï¼š**ä»å›¾ç‰‡ä¸­æ˜¾ç¤ºçš„ç›‘æ§æ•°æ®æ¥çœ‹ï¼Œ`[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` è·¯ç”±ä¼¼ä¹å¹¶æ²¡æœ‰å‡ºç°æ˜æ˜¾çš„é”™è¯¯**ã€‚

## å®é™…æƒ…å†µåˆ†æ

### ä»ç›‘æ§æ•°æ®è§‚å¯Ÿåˆ°çš„ï¼š

**å›¾ç‰‡1ï¼ˆæ—¥å¿—é¡µé¢ï¼‰ï¼š**
- æ˜¾ç¤ºæ­£å¸¸çš„è¯·æ±‚æµé‡å›¾è¡¨
- ç¼“å­˜å‘½ä¸­ç‡æ­£å¸¸
- æ•°æ®ä¼ è¾“é‡æ­£å¸¸

**å›¾ç‰‡2ï¼ˆå¯è§‚å¯Ÿæ€§é¡µé¢ï¼‰ï¼š**
- `[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` è·¯ç”±æ˜¾ç¤ºï¼š
  - è°ƒç”¨æ¬¡æ•°ï¼š102æ¬¡
  - P75å“åº”æ—¶é—´ï¼š28.4%
  - é”™è¯¯ç‡ï¼šçœ‹èµ·æ¥æ˜¯æ­£å¸¸çš„

## é‡æ–°è¯„ä¼°æ‚¨çš„åˆ†æ

æ‚¨æä¾›çš„åˆ†æè™½ç„¶æŠ€æœ¯ä¸Šæ˜¯æ­£ç¡®çš„Next.jså›½é™…åŒ–å¸¸è§é—®é¢˜ï¼Œä½†å¯èƒ½ä¸é€‚ç”¨äºå½“å‰æƒ…å†µï¼Œå› ä¸ºï¼š

1. **æ²¡æœ‰æ˜æ˜¾çš„éƒ¨ç½²é”™è¯¯**ï¼šç›‘æ§æ•°æ®æ˜¾ç¤ºè·¯ç”±åœ¨æ­£å¸¸å“åº”
2. **æ€§èƒ½æŒ‡æ ‡æ­£å¸¸**ï¼šæ²¡æœ‰çœ‹åˆ°å¼‚å¸¸çš„é”™è¯¯ç‡æˆ–å“åº”æ—¶é—´
3. **å¯èƒ½æ˜¯æ­£å¸¸çš„åŠ¨æ€è·¯ç”±**ï¼š`[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` æ˜¯æ ‡å‡†çš„Next.jsåŠ¨æ€è·¯ç”±æ ¼å¼

## éœ€è¦ç¡®è®¤çš„é—®é¢˜

åœ¨æä¾›ä¿®å¤æ–¹æ¡ˆå‰ï¼Œæˆ‘éœ€è¦äº†è§£ï¼š## å‡†ç¡®çš„é—®é¢˜è¯Šæ–­

### å½“å‰çŠ¶å†µè¯„ä¼°

ä»æ‚¨çš„Vercelç›‘æ§æˆªå›¾æ¥çœ‹ï¼Œ**`[è¯­è¨€ç¯å¢ƒ]/æ–‡ç« /[slug]` è·¯ç”±å®é™…ä¸Šåœ¨æ­£å¸¸è¿è¡Œ**ï¼š

1. **æœ‰æ­£å¸¸çš„æµé‡**ï¼š102æ¬¡è°ƒç”¨
2. **å“åº”æ—¶é—´åˆç†**ï¼šP75åœ¨28.4%èŒƒå›´å†…
3. **æ²¡æœ‰æ˜æ˜¾çš„é”™è¯¯ç‡é£™å‡**

### å¯èƒ½çš„æƒ…å†µ

æ‚¨æåˆ°çš„"é”™è¯¯"å¯èƒ½æ˜¯ä»¥ä¸‹å‡ ç§æƒ…å†µä¹‹ä¸€ï¼š

1. **è¿™æ˜¯æ­£å¸¸çš„åŠ¨æ€è·¯ç”±æ˜¾ç¤º**ï¼ŒVercelå°†åŠ¨æ€å‚æ•°æ˜¾ç¤ºä¸º `[å‚æ•°å]` æ ¼å¼
2. **é—´æ­‡æ€§é”™è¯¯**ï¼Œåœ¨æˆªå›¾æ—¶é—´ç‚¹æ²¡æœ‰ä½“ç°
3. **ç‰¹å®šæ¡ä»¶ä¸‹çš„é”™è¯¯**ï¼Œéœ€è¦æ›´è¯¦ç»†çš„é”™è¯¯æ—¥å¿—åˆ†æ

## é‡æ–°ä¼˜åŒ–çš„è¯Šæ–­å’Œè§£å†³æ–¹æ¡ˆ

### ç¬¬ä¸€æ­¥ï¼šç¡®è®¤æ˜¯å¦çœŸçš„å­˜åœ¨é”™è¯¯

```bash
# 1. æ£€æŸ¥Vercelè¯¦ç»†æ—¥å¿—
vercel logs --follow

# 2. æŸ¥çœ‹æ„å»ºæ—¥å¿—
vercel inspect [deployment-url]

# 3. æ£€æŸ¥å‡½æ•°æ—¥å¿—
vercel logs [function-name]
```

### ç¬¬äºŒæ­¥ï¼šå¦‚æœç¡®å®å­˜åœ¨é”™è¯¯ï¼Œé’ˆå¯¹æ€§è§£å†³æ–¹æ¡ˆ## å¯¹æ‚¨åŸå§‹åˆ†æçš„è¯„ä¼°

### ä¼˜ç‚¹ï¼š
- æŠ€æœ¯ä¸Šå‡†ç¡®åœ°æè¿°äº†Next.jså›½é™…åŒ–çš„å¸¸è§é—®é¢˜
- æä¾›äº†å®Œæ•´çš„è§£å†³æ–¹æ¡ˆæ€è·¯
- è€ƒè™‘äº†ç±»å‹å®‰å…¨å’Œé”™è¯¯å¤„ç†

### é—®é¢˜ï¼š
1. **åŸºäºå‡è®¾è€Œéå®é™…è¯æ®**ï¼šä»æˆªå›¾çœ‹ï¼Œè·¯ç”±ä¼¼ä¹åœ¨æ­£å¸¸å·¥ä½œ
2. **è¿‡åº¦å¤æ‚åŒ–**ï¼šå¯èƒ½ä¸éœ€è¦å¦‚æ­¤å¤§çš„æ”¹åŠ¨
3. **ç¼ºå°‘è¯Šæ–­æ­¥éª¤**ï¼šåº”è¯¥å…ˆç¡®è®¤é—®é¢˜ç¡®å®å­˜åœ¨

## æˆ‘çš„å»ºè®®

### ç«‹å³è¡ŒåŠ¨ï¼š
1. **ç¡®è®¤æ˜¯å¦çœŸçš„æœ‰é”™è¯¯**ï¼šæ£€æŸ¥å…·ä½“çš„é”™è¯¯æ—¥å¿—å’Œå †æ ˆè·Ÿè¸ª
2. **å¦‚æœåªæ˜¯ç›‘æ§æ˜¾ç¤º**ï¼šè¿™å¯èƒ½æ˜¯æ­£å¸¸çš„åŠ¨æ€è·¯ç”±ç›‘æ§æ•°æ®

### å¦‚æœç¡®å®å­˜åœ¨é”™è¯¯ï¼š
- ä½¿ç”¨æˆ‘åœ¨artifactä¸­æä¾›çš„æ¸è¿›å¼ä¿®å¤æ–¹æ¡ˆ
- é‡ç‚¹å…³æ³¨é”™è¯¯å¤„ç†å’Œæ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥
- é¿å…å¤§è§„æ¨¡é‡æ„ï¼Œé™¤éç¡®å®å¿…è¦

### å…³é”®å·®å¼‚ï¼š
- **å…ˆè¯Šæ–­ï¼Œå†ä¿®å¤**ï¼šä¸è¦åŸºäºå‡è®¾è¿›è¡Œå¤§è§„æ¨¡æ”¹åŠ¨
- **æ¸è¿›å¼ä¼˜åŒ–**ï¼šä»æœ€å°çš„ä¿®æ”¹å¼€å§‹
- **ä¿æŒç°æœ‰åŠŸèƒ½**ï¼šç¡®ä¿ä¿®å¤ä¸ä¼šç ´åæ­£å¸¸å·¥ä½œçš„éƒ¨åˆ†

æ‚¨è§‰å¾—è¿™ä¸ªåˆ†ææ›´å‡†ç¡®å—ï¼Ÿéœ€è¦æˆ‘ååŠ©æ‚¨è¿›è¡Œå…·ä½“çš„é”™è¯¯è¯Šæ–­å—ï¼Ÿ
