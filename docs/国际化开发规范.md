# å›½é™…åŒ–å¼€å‘è§„èŒƒ

## ğŸ“‹ ç›®å½•

1. [å¼ºåˆ¶è§„åˆ™](#å¼ºåˆ¶è§„åˆ™)
2. [ç¿»è¯‘é”®å‘½åè§„èŒƒ](#ç¿»è¯‘é”®å‘½åè§„èŒƒ)
3. [ä»£ç ç¼–å†™è§„èŒƒ](#ä»£ç ç¼–å†™è§„èŒƒ)
4. [å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ](#å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ)
5. [å¼€å‘æµç¨‹](#å¼€å‘æµç¨‹)
6. [è‡ªåŠ¨åŒ–æ£€æµ‹](#è‡ªåŠ¨åŒ–æ£€æµ‹)

---

## âš ï¸ å¼ºåˆ¶è§„åˆ™

### âŒ ç¦æ­¢çš„åšæ³•

```typescript
// âŒ é”™è¯¯ï¼šç¡¬ç¼–ç æ¡ä»¶æ¸²æŸ“
{locale === "zh" ? "ä¸­æ–‡æ–‡æœ¬" : "English Text"}

// âŒ é”™è¯¯ï¼šç›´æ¥ä½¿ç”¨ä¸­æ–‡/è‹±æ–‡å­—ç¬¦ä¸²
<h1>ä¸­æ–‡æ ‡é¢˜</h1>
<h1>English Title</h1>

// âŒ é”™è¯¯ï¼šåœ¨å˜é‡ä¸­ç¡¬ç¼–ç 
const title = locale === "zh" ? "ä¸­æ–‡" : "English";
```

### âœ… æ­£ç¡®çš„åšæ³•

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ useTranslations hook
const t = useTranslations("namespace");

<h1>{t("title")}</h1>

// âœ… æ­£ç¡®ï¼šåœ¨æœåŠ¡ç«¯ä½¿ç”¨ getTranslations
const t = await getTranslations({ locale, namespace: "namespace" });
```

---

## ğŸ·ï¸ ç¿»è¯‘é”®å‘½åè§„èŒƒ

### å‘½ååŸåˆ™

1. **ä½¿ç”¨è¯­ä¹‰åŒ–çš„é”®å**
   ```typescript
   // âœ… å¥½çš„å‘½å
   interactiveTools.analytics.title
   interactiveTools.analytics.description
   
   // âŒ ç³Ÿç³•çš„å‘½å
   tools.a.t
   page1.text1
   ```

2. **ä¿æŒå±‚çº§ç»“æ„æ¸…æ™°**
   ```json
   {
     "interactiveTools": {
       "analytics": {
         "title": "æ•°æ®åˆ†æ",
         "metrics": {
           "pain": "ç–¼ç—›",
           "mood": "æƒ…ç»ª"
         }
       }
     }
   }
   ```

3. **ä¸­è‹±æ–‡é”®åå®Œå…¨ä¸€è‡´**
   ```json
   // messages/zh.json
   {
     "interactiveTools": {
       "title": "äº’åŠ¨å·¥å…·"
     }
   }
   
   // messages/en.json
   {
     "interactiveTools": {
       "title": "Interactive Tools"
     }
   }
   ```

### å‘½åçº¦å®š

| ç±»å‹ | å‘½åæ¨¡å¼ | ç¤ºä¾‹ |
|------|---------|------|
| é¡µé¢æ ‡é¢˜ | `{namespace}.title` | `analytics.title` |
| é¡µé¢æè¿° | `{namespace}.description` | `analytics.description` |
| æŒ‰é’® | `{namespace}.buttons.{action}` | `analytics.buttons.export` |
| è¡¨å•æ ‡ç­¾ | `{namespace}.form.{field}Label` | `analytics.form.dateLabel` |
| é”™è¯¯æ¶ˆæ¯ | `{namespace}.errors.{errorType}` | `analytics.errors.noData` |
| çŠ¶æ€æ–‡æœ¬ | `{namespace}.status.{state}` | `analytics.status.loading` |

---

## ğŸ’» ä»£ç ç¼–å†™è§„èŒƒ

### 1. ç»„ä»¶ä¸­ä½¿ç”¨ç¿»è¯‘

#### å®¢æˆ·ç«¯ç»„ä»¶ (use client)

```typescript
"use client";

import { useTranslations } from "next-intl";

export default function MyComponent() {
  // å£°æ˜ç¿»è¯‘ hook
  const t = useTranslations("interactiveTools.analytics");
  
  return (
    <div>
      <h1>{t("title")}</h1>
      <p>{t("description")}</p>
      
      {/* å¸¦å‚æ•°çš„ç¿»è¯‘ */}
      <p>{t("userCount", { count: 100 })}</p>
    </div>
  );
}
```

#### æœåŠ¡ç«¯ç»„ä»¶

```typescript
import { getTranslations } from "next-intl/server";

export default async function MyPage({ params }: { params: { locale: string } }) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "interactiveTools.analytics" });
  
  return (
    <div>
      <h1>{t("title")}</h1>
      <p>{t("description")}</p>
    </div>
  );
}
```

### 2. åŠ¨æ€å†…å®¹å¤„ç†

#### ä½¿ç”¨å‚æ•°ä¼ é€’

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨å‚æ•°
const t = useTranslations("messages");

<p>{t("greeting", { name: userName })}</p>

// messages/zh.json
{
  "messages": {
    "greeting": "ä½ å¥½ï¼Œ{name}ï¼"
  }
}

// messages/en.json
{
  "messages": {
    "greeting": "Hello, {name}!"
  }
}
```

#### å¯Œæ–‡æœ¬å†…å®¹

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ rich å‚æ•°
const t = useTranslations("content");

<p>{t.rich("description", {
  strong: (chunks) => <strong>{chunks}</strong>,
  link: (chunks) => <Link href="/help">{chunks}</Link>
})}</p>

// messages/zh.json
{
  "content": {
    "description": "è¿™æ˜¯<strong>é‡è¦</strong>å†…å®¹ï¼ŒæŸ¥çœ‹<link>å¸®åŠ©</link>"
  }
}
```

### 3. æ•°ç»„å’Œå¯¹è±¡ç¿»è¯‘

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ raw è·å–å¯¹è±¡
const t = useTranslations("categories");
const categories = t.raw("list") as Array<{id: string, name: string}>;

// messages/zh.json
{
  "categories": {
    "list": [
      { "id": "all", "name": "å…¨éƒ¨" },
      { "id": "treatment", "name": "æ²»ç–—" }
    ]
  }
}
```

---

## ğŸ› å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ

### é”™è¯¯ 1: MISSING_MESSAGE

**é—®é¢˜ï¼š** `MISSING_MESSAGE: Could not resolve 'key' in messages`

**åŸå› ï¼š**
1. ç¿»è¯‘é”®ä¸å­˜åœ¨
2. å‘½åç©ºé—´ä¸åŒ¹é…
3. JSON ç»“æ„é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
```typescript
// 1. æ£€æŸ¥å‘½åç©ºé—´æ˜¯å¦æ­£ç¡®
const t = useTranslations("interactiveTools.analytics"); // ç¡®è®¤è¿™ä¸ªå‘½åç©ºé—´å­˜åœ¨

// 2. æ£€æŸ¥ç¿»è¯‘é”®è·¯å¾„
t("title") // æ£€æŸ¥ messages/zh.json ä¸­æ˜¯å¦æœ‰ interactiveTools.analytics.title

// 3. ä½¿ç”¨å¼€å‘å·¥å…·æ£€æŸ¥
console.log(t.raw(".")); // æŸ¥çœ‹å½“å‰å‘½åç©ºé—´ä¸‹æ‰€æœ‰é”®
```

### é”™è¯¯ 2: ç»“æ„ä¸ä¸€è‡´

**é—®é¢˜ï¼š** ä¸­è‹±æ–‡ç¿»è¯‘ç»“æ„ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ä½¿ç”¨éªŒè¯è„šæœ¬
npm run verify:translations

# æ‰‹åŠ¨å¯¹æ¯”
# messages/zh.json å’Œ messages/en.json çš„ç»“æ„å¿…é¡»å®Œå…¨ä¸€è‡´
```

### é”™è¯¯ 3: ç¼“å­˜é—®é¢˜

**é—®é¢˜ï¼š** ä¿®æ”¹ç¿»è¯‘åä¸ç”Ÿæ•ˆ

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# å¼ºåˆ¶æ¸…é™¤ç¼“å­˜
rm -rf .next
npm run dev

# æˆ–ä½¿ç”¨å¿«æ·å‘½ä»¤
npm run dev:clean
```

---

## ğŸ”„ å¼€å‘æµç¨‹

### æ·»åŠ æ–°é¡µé¢/ç»„ä»¶çš„å›½é™…åŒ–

#### Step 1: è§„åˆ’ç¿»è¯‘é”®ç»“æ„

```
interactiveTools.myNewFeature
â”œâ”€â”€ title
â”œâ”€â”€ description
â”œâ”€â”€ buttons
â”‚   â”œâ”€â”€ submit
â”‚   â””â”€â”€ cancel
â””â”€â”€ form
    â”œâ”€â”€ nameLabel
    â””â”€â”€ emailLabel
```

#### Step 2: æ·»åŠ ç¿»è¯‘é”®ï¼ˆåŒæ—¶æ›´æ–° zh.json å’Œ en.jsonï¼‰

```json
// messages/zh.json
{
  "interactiveTools": {
    "myNewFeature": {
      "title": "æˆ‘çš„æ–°åŠŸèƒ½",
      "description": "åŠŸèƒ½æè¿°",
      "buttons": {
        "submit": "æäº¤",
        "cancel": "å–æ¶ˆ"
      }
    }
  }
}

// messages/en.json
{
  "interactiveTools": {
    "myNewFeature": {
      "title": "My New Feature",
      "description": "Feature description",
      "buttons": {
        "submit": "Submit",
        "cancel": "Cancel"
      }
    }
  }
}
```

#### Step 3: åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```typescript
"use client";

import { useTranslations } from "next-intl";

export default function MyNewFeature() {
  const t = useTranslations("interactiveTools.myNewFeature");
  
  return (
    <div>
      <h1>{t("title")}</h1>
      <p>{t("description")}</p>
      <button>{t("buttons.submit")}</button>
      <button>{t("buttons.cancel")}</button>
    </div>
  );
}
```

#### Step 4: éªŒè¯

```bash
# 1. æ¸…é™¤ç¼“å­˜
rm -rf .next

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 3. æµ‹è¯•ä¸­æ–‡é¡µé¢
curl http://localhost:3001/zh/your-page

# 4. æµ‹è¯•è‹±æ–‡é¡µé¢
curl http://localhost:3001/en/your-page

# 5. æ£€æŸ¥æ§åˆ¶å°æ— é”™è¯¯
```

---

## ğŸ”§ è‡ªåŠ¨åŒ–æ£€æµ‹

### ä½¿ç”¨æ™ºèƒ½æ£€æµ‹å·¥å…·

```bash
# æ£€æµ‹æ‰€æœ‰ç¡¬ç¼–ç 
npm run detect:hardcode

# éªŒè¯ç¿»è¯‘å®Œæ•´æ€§
npm run verify:translations

# æ¸…ç†ç¼“å­˜å¹¶å¯åŠ¨
npm run dev:clean
```

### Git Hooks

Pre-commit hook ä¼šè‡ªåŠ¨æ£€æµ‹ï¼š
- âœ… æ–°å¢çš„ç¡¬ç¼–ç æ¨¡å¼
- âœ… ç¿»è¯‘é”®ç¼ºå¤±
- âœ… JSON è¯­æ³•é”™è¯¯
- âœ… ç»“æ„ä¸ä¸€è‡´

å¦‚æœæ£€æµ‹åˆ°é—®é¢˜ï¼Œæäº¤ä¼šè¢«é˜»æ­¢ï¼Œéœ€è¦å…ˆä¿®å¤ã€‚

---

## âœ… æ£€æŸ¥æ¸…å•

### å¼€å‘æ–°åŠŸèƒ½æ—¶

- [ ] æ‰€æœ‰ç”¨æˆ·å¯è§æ–‡æœ¬ä½¿ç”¨ç¿»è¯‘é”®
- [ ] ç¿»è¯‘é”®å‘½åç¬¦åˆè§„èŒƒ
- [ ] ä¸­è‹±æ–‡ç¿»è¯‘å·²å®Œæ•´æ·»åŠ 
- [ ] ç¿»è¯‘é”®ç»“æ„åœ¨ zh.json å’Œ en.json ä¸­ä¸€è‡´
- [ ] å·²é€šè¿‡è‡ªåŠ¨åŒ–æ£€æµ‹
- [ ] æ¸…é™¤ç¼“å­˜åéªŒè¯ä¸­è‹±æ–‡é¡µé¢
- [ ] æ— æ§åˆ¶å°é”™è¯¯
- [ ] åŠŸèƒ½æ­£å¸¸

### ä¿®å¤ç¡¬ç¼–ç æ—¶

- [ ] åˆ›å»º backup commit
- [ ] åˆ†æç¡¬ç¼–ç ç±»å‹å’Œæ•°é‡
- [ ] è§„åˆ’ç¿»è¯‘é”®ç»“æ„
- [ ] æ·»åŠ ç¿»è¯‘é”®ï¼ˆzh + enï¼‰
- [ ] ä¿®å¤ä»£ç ï¼Œæ›¿æ¢ç¡¬ç¼–ç ä¸º t() è°ƒç”¨
- [ ] æ£€æŸ¥ Lint é”™è¯¯
- [ ] **æ¸…é™¤ç¼“å­˜** (`rm -rf .next`)
- [ ] éªŒè¯ä¸­æ–‡é¡µé¢
- [ ] éªŒè¯è‹±æ–‡é¡µé¢
- [ ] æ— æ§åˆ¶å°é”™è¯¯
- [ ] æäº¤ä¿®å¤

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [next-intl å®˜æ–¹æ–‡æ¡£](https://next-intl-docs.vercel.app/)
- [é¡¹ç›®ç¿»è¯‘é”®åŒæ­¥æœºåˆ¶](../ç¿»è¯‘é”®åŒæ­¥æœºåˆ¶ä¸é¢„é˜²æªæ–½.md)
- [P2ä¿®å¤ç»éªŒæ€»ç»“](./P2ä¿®å¤ç»éªŒæ€»ç»“.md)

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025-01-07  
**ç»´æŠ¤è€…ï¼š** PeriodHub Team
