#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” è¿è¡Œ pre-push éªŒè¯..."
echo ""

# éªŒè¯ JSON è¯­æ³•
echo "ğŸ” éªŒè¯ JSON è¯­æ³•..."
if ! node -e "JSON.parse(require('fs').readFileSync('messages/zh.json', 'utf8'))"; then
    echo "âŒ messages/zh.json è¯­æ³•é”™è¯¯ï¼"
    exit 1
fi

if ! node -e "JSON.parse(require('fs').readFileSync('messages/en.json', 'utf8'))"; then
    echo "âŒ messages/en.json è¯­æ³•é”™è¯¯ï¼"
    exit 1
fi

echo "âœ… JSON è¯­æ³•éªŒè¯é€šè¿‡"
echo ""

# è¿è¡Œå®Œæ•´çš„ç¿»è¯‘é”®éªŒè¯
echo "ğŸ” è¿è¡Œå®Œæ•´ç¿»è¯‘é”®éªŒè¯..."
if ! node scripts/check-translation-sync.js; then
    echo ""
    echo "âŒ ç¿»è¯‘é”®éªŒè¯å¤±è´¥ï¼"
    echo "è¯·ä¿®å¤æ‰€æœ‰ç¿»è¯‘é”®é—®é¢˜åå†æ¨é€ã€‚"
    echo ""
    exit 1
fi

echo ""
echo "âœ… æ‰€æœ‰ pre-push éªŒè¯é€šè¿‡ï¼"
